<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="FE 前端 JavaScript HTML CSS React Vue Webpack Rollup babel React Native Flutter 小程序 算法"><meta name="keywords" content=""><meta name="author" content="TheFirstSunday,undefined"><meta name="copyright" content="TheFirstSunday"><title>coder【前端-FE】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"V5C7R11NIT","apiKey":"37d9271c02b1e0f2f42bd334f8f0de94","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {},
  valine: {"appId":"EDiQLCtfYJFYtECr3Adwmncl-gzGzoHsz","appKey":"MDXLAYtR8IlmgStY29ElIjge","placeholder":"Just Go Go."},
}</script><meta name="generator" content="Hexo 5.2.0"></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">设计模式分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.1.</span> <span class="toc-text">创建型模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%80%A7%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">结构性模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.3.</span> <span class="toc-text">行为模式</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">TheFirstSunday</div><div class="author-info-description">FE 前端 JavaScript HTML CSS React Vue Webpack Rollup babel React Native Flutter 小程序 算法</div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/TheFirstSunday" target="_blank">GitHub<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="mailto:zhaonan266366@163.com" target="_blank">Email<i class="icon-dot bg-color5"></i></a><a class="links-button button-hover" href="tencent://message/?uin=2621940203&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">10</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">2</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">1</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">前端-FE</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title"></div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2021-01-29 | 更新于 2021-01-29</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"></div><div class="button-hover tags"></div></div></div><div class="main-content"><h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><hr>
<p>设计模式是软件设计中常见问题的典型解决方案。 每个模式就像一张蓝图， 你可以通过对其进行定制来解决代码中的特定设计问题。</p>
<h2 id="设计模式分类"><a href="#设计模式分类" class="headerlink" title="设计模式分类"></a>设计模式分类</h2><p>不同设计模式的复杂程度、 细节层次以及在整个系统中的应用范围等方面各不相同。 我喜欢将其类比于道路的建造： 如果你希望让十字路口更加安全， 那么可以安装一些交通信号灯， 或者修建包含行人地下通道在内的多层互通式立交桥。<br>最基础的、 底层的模式通常被称为惯用技巧。 这类模式一般只能在一种编程语言中使用。<br>最通用的、 高层的模式是构架模式。 开发者可以在任何编程语言中使用这类模式。 与其他模式不同， 它们可用于整个应用程序的架构设计。<br>此外， 所有模式可以根据其意图或目的来分类。 三种主要的模式类别：</p>
<ul>
<li>创建型模式提供创建对象的机制， 增加已有代码的灵活性和可复用性。</li>
<li>结构型模式介绍如何将对象和类组装成较大的结构， 并同时保持结构的灵活和高效。</li>
<li>行为模式负责对象间的高效沟通和职责委派。</li>
</ul>
<h3 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h3><ul>
<li><p>工厂模式: 工厂方法模式是一种创建型设计模式， 其在父类中提供一个创建对象的方法， 允许子类决定实例化对象的类型。</p>
<p>工厂方法模式优缺点:<br>  优点:</p>
<pre><code>1. 你可以避免创建者和具体产品之间的紧密耦合。
2. 单一职责原则。你可以将产品创建代码放在程序的单一位置， 从而使得代码更容易维护。
3. 开闭原则。 无需更改现有客户端代码， 你就可以在程序中引入新的产品类型。</code></pre>
<p>  缺点:</p>
<pre><code>1.应用工厂方法模式需要引入许多新的子类， 代码可能会因此变得更复杂。 最好的情况是将该模式引入创建者类的现有层次结构中。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Creator class declares the factory method that is supposed to return an</span></span><br><span class="line"><span class="comment"> * object of a Product class. The Creator&#x27;s subclasses usually provide the</span></span><br><span class="line"><span class="comment"> * implementation of this method.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Creator &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Note that the Creator may also provide some default implementation of the</span></span><br><span class="line"><span class="comment">     * factory method.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> factoryMethod(): Product;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Also note that, despite its name, the Creator&#x27;s primary responsibility is</span></span><br><span class="line"><span class="comment">     * not creating products. Usually, it contains some core business logic that</span></span><br><span class="line"><span class="comment">     * relies on Product objects, returned by the factory method. Subclasses can</span></span><br><span class="line"><span class="comment">     * indirectly change that business logic by overriding the factory method</span></span><br><span class="line"><span class="comment">     * and returning a different type of product from it.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> someOperation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="comment">// Call the factory method to create a Product object.</span></span><br><span class="line">        <span class="keyword">const</span> product = <span class="built_in">this</span>.factoryMethod();</span><br><span class="line">        <span class="comment">// Now, use the product.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Creator: The same creator&#x27;s code has just worked with <span class="subst">$&#123;product.operation()&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Creators override the factory method in order to change the</span></span><br><span class="line"><span class="comment"> * resulting product&#x27;s type.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteCreator1 <span class="keyword">extends</span> Creator &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Note that the signature of the method still uses the abstract product</span></span><br><span class="line"><span class="comment">     * type, even though the concrete product is actually returned from the</span></span><br><span class="line"><span class="comment">     * method. This way the Creator can stay independent of concrete product</span></span><br><span class="line"><span class="comment">     * classes.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> factoryMethod(): Product &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteCreator2 <span class="keyword">extends</span> Creator &#123;</span><br><span class="line">    <span class="keyword">public</span> factoryMethod(): Product &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Product interface declares the operations that all concrete products must</span></span><br><span class="line"><span class="comment"> * implement.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Product &#123;</span><br><span class="line">    operation(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Products provide various implementations of the Product interface.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteProduct1 <span class="keyword">implements</span> Product &#123;</span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;Result of the ConcreteProduct1&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteProduct2 <span class="keyword">implements</span> Product &#123;</span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;Result of the ConcreteProduct2&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code works with an instance of a concrete creator, albeit through</span></span><br><span class="line"><span class="comment"> * its base interface. As long as the client keeps working with the creator via</span></span><br><span class="line"><span class="comment"> * the base interface, you can pass it any creator&#x27;s subclass.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">creator: Creator</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Client: I\&#x27;m not aware of the creator\&#x27;s class, but it still works.&#x27;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(creator.someOperation());</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Application picks a creator&#x27;s type depending on the configuration or</span></span><br><span class="line"><span class="comment"> * environment.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;App: Launched with the ConcreteCreator1.&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteCreator1());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;App: Launched with the ConcreteCreator2.&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteCreator2());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">OUTPUT: 执行结果</span><br><span class="line">App: Launched <span class="keyword">with</span> the ConcreteCreator1.</span><br><span class="line">Client: I<span class="string">&#x27;m not aware of the creator&#x27;</span>s <span class="keyword">class</span>, but it still works.</span><br><span class="line">Creator: The same creator<span class="string">&#x27;s code has just worked with &#123;Result of the ConcreteProduct1&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">App: Launched with the ConcreteCreator2.</span></span><br><span class="line"><span class="string">Client: I&#x27;</span>m not aware <span class="keyword">of</span> the creator<span class="string">&#x27;s class, but it still works.</span></span><br><span class="line"><span class="string">Creator: The same creator&#x27;</span>s code has just worked <span class="keyword">with</span> &#123;Result <span class="keyword">of</span> the ConcreteProduct2&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>抽象工厂模式: 抽象工厂模式是一种创建型设计模式， 它能创建一系列相关的对象， 而无需指定其具体类。</li>
</ul>
<p>抽象工厂模式优缺点:<br>    优点:<br>        1.你可以确保同一工厂生成的产品相互匹配。<br>        2.你可以避免客户端和具体产品代码的耦合。<br>        3.单一职责原则。 你可以将产品生成代码抽取到同一位置， 使得代码易于维护。<br>        4.开闭原则。 向应用程序中引入新产品变体时， 你无需修改客户端代码。<br>    缺点:<br>        1.由于采用该模式需要向应用中引入众多接口和类， 代码可能会比之前更加复杂。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Abstract Factory interface declares a set of methods that return</span></span><br><span class="line"><span class="comment"> * different abstract products. These products are called a family and are</span></span><br><span class="line"><span class="comment"> * related by a high-level theme or concept. Products of one family are usually</span></span><br><span class="line"><span class="comment"> * able to collaborate among themselves. A family of products may have several</span></span><br><span class="line"><span class="comment"> * variants, but the products of one variant are incompatible with products of</span></span><br><span class="line"><span class="comment"> * another.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> AbstractFactory &#123;</span><br><span class="line">    createProductA(): AbstractProductA;</span><br><span class="line"></span><br><span class="line">    createProductB(): AbstractProductB;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Factories produce a family of products that belong to a single</span></span><br><span class="line"><span class="comment"> * variant. The factory guarantees that resulting products are compatible. Note</span></span><br><span class="line"><span class="comment"> * that signatures of the Concrete Factory&#x27;s methods return an abstract product,</span></span><br><span class="line"><span class="comment"> * while inside the method a concrete product is instantiated.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteFactory1 <span class="keyword">implements</span> AbstractFactory &#123;</span><br><span class="line">    <span class="keyword">public</span> createProductA(): AbstractProductA &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProductA1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> createProductB(): AbstractProductB &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProductB1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Each Concrete Factory has a corresponding product variant.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteFactory2 <span class="keyword">implements</span> AbstractFactory &#123;</span><br><span class="line">    <span class="keyword">public</span> createProductA(): AbstractProductA &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProductA2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> createProductB(): AbstractProductB &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProductB2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Each distinct product of a product family should have a base interface. All</span></span><br><span class="line"><span class="comment"> * variants of the product must implement this interface.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> AbstractProductA &#123;</span><br><span class="line">    usefulFunctionA(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * These Concrete Products are created by corresponding Concrete Factories.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteProductA1 <span class="keyword">implements</span> AbstractProductA &#123;</span><br><span class="line">    <span class="keyword">public</span> usefulFunctionA(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;The result of the product A1.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteProductA2 <span class="keyword">implements</span> AbstractProductA &#123;</span><br><span class="line">    <span class="keyword">public</span> usefulFunctionA(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;The result of the product A2.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Here&#x27;s the the base interface of another product. All products can interact</span></span><br><span class="line"><span class="comment"> * with each other, but proper interaction is possible only between products of</span></span><br><span class="line"><span class="comment"> * the same concrete variant.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> AbstractProductB &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Product B is able to do its own thing...</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    usefulFunctionB(): <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ...but it also can collaborate with the ProductA.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * The Abstract Factory makes sure that all products it creates are of the</span></span><br><span class="line"><span class="comment">     * same variant and thus, compatible.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    anotherUsefulFunctionB(collaborator: AbstractProductA): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * These Concrete Products are created by corresponding Concrete Factories.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteProductB1 <span class="keyword">implements</span> AbstractProductB &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> usefulFunctionB(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;The result of the product B1.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The variant, Product B1, is only able to work correctly with the variant,</span></span><br><span class="line"><span class="comment">     * Product A1. Nevertheless, it accepts any instance of AbstractProductA as</span></span><br><span class="line"><span class="comment">     * an argument.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> anotherUsefulFunctionB(collaborator: AbstractProductA): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = collaborator.usefulFunctionA();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`The result of the B1 collaborating with the (<span class="subst">$&#123;result&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteProductB2 <span class="keyword">implements</span> AbstractProductB &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> usefulFunctionB(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;The result of the product B2.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The variant, Product B2, is only able to work correctly with the variant,</span></span><br><span class="line"><span class="comment">     * Product A2. Nevertheless, it accepts any instance of AbstractProductA as</span></span><br><span class="line"><span class="comment">     * an argument.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> anotherUsefulFunctionB(collaborator: AbstractProductA): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = collaborator.usefulFunctionA();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`The result of the B2 collaborating with the (<span class="subst">$&#123;result&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code works with factories and products only through abstract</span></span><br><span class="line"><span class="comment"> * types: AbstractFactory and AbstractProduct. This lets you pass any factory or</span></span><br><span class="line"><span class="comment"> * product subclass to the client code without breaking it.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">factory: AbstractFactory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> productA = factory.createProductA();</span><br><span class="line">    <span class="keyword">const</span> productB = factory.createProductB();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(productB.usefulFunctionB());</span><br><span class="line">    <span class="built_in">console</span>.log(productB.anotherUsefulFunctionB(productA));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code can work with any concrete factory class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Testing client code with the first factory type...&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteFactory1());</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Testing the same client code with the second factory type...&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteFactory2());</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Client: Testing client code <span class="keyword">with</span> the first factory <span class="keyword">type</span>...</span><br><span class="line">The result <span class="keyword">of</span> the product B1.</span><br><span class="line">The result <span class="keyword">of</span> the B1 collaborating <span class="keyword">with</span> the (The result <span class="keyword">of</span> the product A1.)</span><br><span class="line"></span><br><span class="line">Client: Testing the same client code <span class="keyword">with</span> the second factory <span class="keyword">type</span>...</span><br><span class="line">The result <span class="keyword">of</span> the product B2.</span><br><span class="line">The result <span class="keyword">of</span> the B2 collaborating <span class="keyword">with</span> the (The result <span class="keyword">of</span> the product A2.)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>生成器模式: 生成器模式是一种创建型设计模式， 使你能够分步骤创建复杂对象。 该模式允许你使用相同的创建代码生成不同类型和形式的对象。</p>
<p>生成器模式优缺点:<br>  优点:</p>
<pre><code>  1.你可以分步创建对象， 暂缓创建步骤或递归运行创建步骤。
  2.生成不同形式的产品时， 你可以复用相同的制造代码。
  3.单一职责原则。 你可以将复杂构造代码从产品的业务逻辑中分离出来。</code></pre>
<p>  缺点:</p>
<pre><code>  由于该模式需要新增多个类， 因此代码整体复杂程度会有所增加。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Builder interface specifies methods for creating the different parts of</span></span><br><span class="line"><span class="comment"> * the Product objects.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Builder &#123;</span><br><span class="line">    producePartA(): <span class="built_in">void</span>;</span><br><span class="line">    producePartB(): <span class="built_in">void</span>;</span><br><span class="line">    producePartC(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Concrete Builder classes follow the Builder interface and provide</span></span><br><span class="line"><span class="comment"> * specific implementations of the building steps. Your program may have several</span></span><br><span class="line"><span class="comment"> * variations of Builders, implemented differently.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteBuilder1 <span class="keyword">implements</span> Builder &#123;</span><br><span class="line">    <span class="keyword">private</span> product: Product1;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A fresh builder instance should contain a blank product object, which is</span></span><br><span class="line"><span class="comment">     * used in further assembly.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.reset();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> reset(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.product = <span class="keyword">new</span> Product1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * All production steps work with the same product instance.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> producePartA(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.product.parts.push(<span class="string">&#x27;PartA1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> producePartB(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.product.parts.push(<span class="string">&#x27;PartB1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> producePartC(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.product.parts.push(<span class="string">&#x27;PartC1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Concrete Builders are supposed to provide their own methods for</span></span><br><span class="line"><span class="comment">     * retrieving results. That&#x27;s because various types of builders may create</span></span><br><span class="line"><span class="comment">     * entirely different products that don&#x27;t follow the same interface.</span></span><br><span class="line"><span class="comment">     * Therefore, such methods cannot be declared in the base Builder interface</span></span><br><span class="line"><span class="comment">     * (at least in a statically typed programming language).</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Usually, after returning the end result to the client, a builder instance</span></span><br><span class="line"><span class="comment">     * is expected to be ready to start producing another product. That&#x27;s why</span></span><br><span class="line"><span class="comment">     * it&#x27;s a usual practice to call the reset method at the end of the</span></span><br><span class="line"><span class="comment">     * `getProduct` method body. However, this behavior is not mandatory, and</span></span><br><span class="line"><span class="comment">     * you can make your builders wait for an explicit reset call from the</span></span><br><span class="line"><span class="comment">     * client code before disposing of the previous result.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> getProduct(): Product1 &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">this</span>.product;</span><br><span class="line">        <span class="built_in">this</span>.reset();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * It makes sense to use the Builder pattern only when your products are quite</span></span><br><span class="line"><span class="comment"> * complex and require extensive configuration.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Unlike in other creational patterns, different concrete builders can produce</span></span><br><span class="line"><span class="comment"> * unrelated products. In other words, results of various builders may not</span></span><br><span class="line"><span class="comment"> * always follow the same interface.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Product1 &#123;</span><br><span class="line">    <span class="keyword">public</span> parts: <span class="built_in">string</span>[] = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> listParts(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Product parts: <span class="subst">$&#123;<span class="built_in">this</span>.parts.join(<span class="string">&#x27;, &#x27;</span>)&#125;</span>\n`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Director is only responsible for executing the building steps in a</span></span><br><span class="line"><span class="comment"> * particular sequence. It is helpful when producing products according to a</span></span><br><span class="line"><span class="comment"> * specific order or configuration. Strictly speaking, the Director class is</span></span><br><span class="line"><span class="comment"> * optional, since the client can control builders directly.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Director &#123;</span><br><span class="line">    <span class="keyword">private</span> builder: Builder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Director works with any builder instance that the client code passes</span></span><br><span class="line"><span class="comment">     * to it. This way, the client code may alter the final type of the newly</span></span><br><span class="line"><span class="comment">     * assembled product.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> setBuilder(builder: Builder): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.builder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Director can construct several product variations using the same</span></span><br><span class="line"><span class="comment">     * building steps.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> buildMinimalViableProduct(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.builder.producePartA();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> buildFullFeaturedProduct(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.builder.producePartA();</span><br><span class="line">        <span class="built_in">this</span>.builder.producePartB();</span><br><span class="line">        <span class="built_in">this</span>.builder.producePartC();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code creates a builder object, passes it to the director and then</span></span><br><span class="line"><span class="comment"> * initiates the construction process. The end result is retrieved from the</span></span><br><span class="line"><span class="comment"> * builder object.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">director: Director</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> builder = <span class="keyword">new</span> ConcreteBuilder1();</span><br><span class="line">    director.setBuilder(builder);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Standard basic product:&#x27;</span>);</span><br><span class="line">    director.buildMinimalViableProduct();</span><br><span class="line">    builder.getProduct().listParts();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Standard full featured product:&#x27;</span>);</span><br><span class="line">    director.buildFullFeaturedProduct();</span><br><span class="line">    builder.getProduct().listParts();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remember, the Builder pattern can be used without a Director class.</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Custom product:&#x27;</span>);</span><br><span class="line">    builder.producePartA();</span><br><span class="line">    builder.producePartC();</span><br><span class="line">    builder.getProduct().listParts();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> director = <span class="keyword">new</span> Director();</span><br><span class="line">clientCode(director);</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Standard basic product:</span><br><span class="line">Product parts: PartA1</span><br><span class="line"></span><br><span class="line">Standard full featured product:</span><br><span class="line">Product parts: PartA1, PartB1, PartC1</span><br><span class="line"></span><br><span class="line">Custom product:</span><br><span class="line">Product parts: PartA1, PartC1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>原型模式: 原型模式是一种创建型设计模式， 使你能够复制已有对象， 而又无需使代码依赖它们所属的类。</li>
</ul>
<p>原型模式优缺点:<br>    优点:<br>        1.你可以克隆对象， 而无需与它们所属的具体类相耦合。<br>        2.你可以克隆预生成原型， 避免反复运行初始化代码。<br>        3.你可以更方便地生成复杂对象。<br>        4.你可以用继承以外的方式来处理复杂对象的不同配置。<br>    缺点:<br>        1.克隆包含循环引用的复杂对象可能会非常麻烦。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The example class that has cloning ability. We&#x27;ll see how the values of field</span></span><br><span class="line"><span class="comment"> * with different types will be cloned.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Prototype &#123;</span><br><span class="line">    <span class="keyword">public</span> primitive: <span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">public</span> component: <span class="built_in">object</span>;</span><br><span class="line">    <span class="keyword">public</span> circularReference: ComponentWithBackReference;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> clone(): <span class="built_in">this</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> clone = <span class="built_in">Object</span>.create(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        clone.component = <span class="built_in">Object</span>.create(<span class="built_in">this</span>.component);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Cloning an object that has a nested object with backreference</span></span><br><span class="line">        <span class="comment">// requires special treatment. After the cloning is completed, the</span></span><br><span class="line">        <span class="comment">// nested object should point to the cloned object, instead of the</span></span><br><span class="line">        <span class="comment">// original object. Spread operator can be handy for this case.</span></span><br><span class="line">        clone.circularReference = &#123;</span><br><span class="line">            ...this.circularReference,</span><br><span class="line">            prototype: &#123; ...this &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clone;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ComponentWithBackReference &#123;</span><br><span class="line">    <span class="keyword">public</span> prototype;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">prototype: Prototype</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.prototype = prototype;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The client code.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p1 = <span class="keyword">new</span> Prototype();</span><br><span class="line">    p1.primitive = <span class="number">245</span>;</span><br><span class="line">    p1.component = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    p1.circularReference = <span class="keyword">new</span> ComponentWithBackReference(p1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> p2 = p1.clone();</span><br><span class="line">    <span class="keyword">if</span> (p1.primitive === p2.primitive) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Primitive field values have been carried over to a clone. Yay!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Primitive field values have not been copied. Booo!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p1.component === p2.component) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Simple component has not been cloned. Booo!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Simple component has been cloned. Yay!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (p1.circularReference === p2.circularReference) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component with back reference has not been cloned. Booo!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component with back reference has been cloned. Yay!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (p1.circularReference.prototype === p2.circularReference.prototype) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component with back reference is linked to original object. Booo!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component with back reference is linked to the clone. Yay!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clientCode();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Primitive field values have been carried over to a clone. Yay!</span><br><span class="line">Simple component has been cloned. Yay!</span><br><span class="line">Component <span class="keyword">with</span> back reference has been cloned. Yay!</span><br><span class="line">Component <span class="keyword">with</span> back reference is linked to the clone. Yay!</span><br></pre></td></tr></table></figure>

<ul>
<li><p>单例模式: 单例模式是一种创建型设计模式， 让你能够保证一个类只有一个实例， 并提供一个访问该实例的全局节点。</p>
<p>单例模式的优缺点:<br>  优点:  </p>
<pre><code>  1.你可以保证一个类只有一个实例。
  2.你获得了一个指向该实例的全局访问节点。
  3.仅在首次请求单例对象时对其进行初始化。</code></pre>
<p>  缺点:</p>
<pre><code>  1.违反了_单一职责原则_。 该模式同时解决了两个问题。
  2.单例模式可能掩盖不良设计， 比如程序各组件之间相互了解过多等。
  3.该模式在多线程环境下需要进行特殊处理， 避免多个线程多次创建单例对象。
  4.单例的客户端代码单元测试可能会比较困难， 因为许多测试框架以基于继承的方式创建模拟对象。 由于单例类的构造函数是私有的， 而且绝大部分语言无法重写静态方法， 所以你需要想出仔细考虑模拟单例的方法。 要么干脆不编写测试代码， 或者不使用单例模式。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Singleton class defines the `getInstance` method that lets clients access</span></span><br><span class="line"><span class="comment"> * the unique singleton instance.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Singleton &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> instance: Singleton;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Singleton&#x27;s constructor should always be private to prevent direct</span></span><br><span class="line"><span class="comment">     * construction calls with the `new` operator.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The static method that controls the access to the singleton instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * This implementation let you subclass the Singleton class while keeping</span></span><br><span class="line"><span class="comment">     * just one instance of each subclass around.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> getInstance(): Singleton &#123;</span><br><span class="line">        <span class="keyword">if</span> (!Singleton.instance) &#123;</span><br><span class="line">            Singleton.instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Singleton.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Finally, any singleton should define some business logic, which can be</span></span><br><span class="line"><span class="comment">     * executed on its instance.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> someBusinessLogic() &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> s1 = Singleton.getInstance();</span><br><span class="line">    <span class="keyword">const</span> s2 = Singleton.getInstance();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (s1 === s2) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Singleton works, both variables contain the same instance.&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Singleton failed, variables contain different instances.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clientCode();</span><br><span class="line"></span><br><span class="line">Output.txt: 执行结果</span><br><span class="line">Singleton works, both variables contain the same instance.</span><br></pre></td></tr></table></figure>

<h3 id="结构性模式"><a href="#结构性模式" class="headerlink" title="结构性模式"></a>结构性模式</h3><ul>
<li><p>适配器模式: 适配器模式是一种结构型设计模式， 它能使接口不兼容的对象能够相互合作。</p>
<p>适配器模式优缺点:<br>  优点:</p>
<pre><code>  1._单一职责原则_你可以将接口或数据转换代码从程序主要业务逻辑中分离。
  2.开闭原则。 只要客户端代码通过客户端接口与适配器进行交互， 你就能在不修改现有客户端代码的情况下在程序中添加新类型的适配器。</code></pre>
<p>  缺点:</p>
<pre><code>  1.代码整体复杂度增加， 因为你需要新增一系列接口和类。 有时直接更改服务类使其与其他代码兼容会更简单。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The Target defines the domain-specific interface used by the client code.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> Target &#123;</span><br><span class="line">    <span class="keyword">public</span> request(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Target: The default target\&#x27;s behavior.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The Adaptee contains some useful behavior, but its interface is incompatible</span></span><br><span class="line"><span class="comment">* with the existing client code. The Adaptee needs some adaptation before the</span></span><br><span class="line"><span class="comment">* client code can use it.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> Adaptee &#123;</span><br><span class="line">    <span class="keyword">public</span> specificRequest(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;.eetpadA eht fo roivaheb laicepS&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The Adapter makes the Adaptee&#x27;s interface compatible with the Target&#x27;s</span></span><br><span class="line"><span class="comment">* interface.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> Adapter <span class="keyword">extends</span> Target &#123;</span><br><span class="line">    <span class="keyword">private</span> adaptee: Adaptee;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">adaptee: Adaptee</span>) &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.adaptee = adaptee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> request(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">this</span>.adaptee.specificRequest().split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Adapter: (TRANSLATED) <span class="subst">$&#123;result&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The client code supports all classes that follow the Target interface.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">target: Target</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(target.request());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: I can work just fine with the Target objects:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> target = <span class="keyword">new</span> Target();</span><br><span class="line">clientCode(target);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> adaptee = <span class="keyword">new</span> Adaptee();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: The Adaptee class has a weird interface. See, I don\&#x27;t understand it:&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Adaptee: <span class="subst">$&#123;adaptee.specificRequest()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: But I can work with it via the Adapter:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> adapter = <span class="keyword">new</span> Adapter(adaptee);</span><br><span class="line">clientCode(adapter);</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Client: I can work just fine <span class="keyword">with</span> the Target objects:</span><br><span class="line">Target: The <span class="keyword">default</span> target<span class="string">&#x27;s behavior.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Client: The Adaptee class has a weird interface. See, I don&#x27;</span>t understand it:</span><br><span class="line">Adaptee: .eetpadA eht fo roivaheb laicepS</span><br><span class="line"></span><br><span class="line">Client: But I can work <span class="keyword">with</span> it via the Adapter:</span><br><span class="line">Adapter: (TRANSLATED) Special behavior <span class="keyword">of</span> the Adaptee.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>桥接模式: 桥接模式是一种结构型设计模式， 可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构， 从而能在开发时分别使用。</p>
<p>桥接模式优缺点:<br>  优点:</p>
<pre><code>  1.你可以创建与平台无关的类和程序。
  2.客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息。
  3.开闭原则。 你可以新增抽象部分和实现部分， 且它们之间不会相互影响。
  4.单一职责原则。 抽象部分专注于处理高层逻辑， 实现部分处理平台细节。</code></pre>
<p>  缺点:</p>
<pre><code>  1.对高内聚的类使用该模式可能会让代码更加复杂。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Abstraction defines the interface for the &quot;control&quot; part of the two class</span></span><br><span class="line"><span class="comment"> * hierarchies. It maintains a reference to an object of the Implementation</span></span><br><span class="line"><span class="comment"> * hierarchy and delegates all of the real work to this object.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Abstraction &#123;</span><br><span class="line">    <span class="keyword">protected</span> implementation: Implementation;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">implementation: Implementation</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.implementation = implementation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">this</span>.implementation.operationImplementation();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Abstraction: Base operation with:\n<span class="subst">$&#123;result&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * You can extend the Abstraction without changing the Implementation classes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ExtendedAbstraction <span class="keyword">extends</span> Abstraction &#123;</span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">this</span>.implementation.operationImplementation();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`ExtendedAbstraction: Extended operation with:\n<span class="subst">$&#123;result&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Implementation defines the interface for all implementation classes. It</span></span><br><span class="line"><span class="comment"> * doesn&#x27;t have to match the Abstraction&#x27;s interface. In fact, the two</span></span><br><span class="line"><span class="comment"> * interfaces can be entirely different. Typically the Implementation interface</span></span><br><span class="line"><span class="comment"> * provides only primitive operations, while the Abstraction defines higher-</span></span><br><span class="line"><span class="comment"> * level operations based on those primitives.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Implementation &#123;</span><br><span class="line">    operationImplementation(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Each Concrete Implementation corresponds to a specific platform and</span></span><br><span class="line"><span class="comment"> * implements the Implementation interface using that platform&#x27;s API.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteImplementationA <span class="keyword">implements</span> Implementation &#123;</span><br><span class="line">    <span class="keyword">public</span> operationImplementation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ConcreteImplementationA: Here\&#x27;s the result on the platform A.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteImplementationB <span class="keyword">implements</span> Implementation &#123;</span><br><span class="line">    <span class="keyword">public</span> operationImplementation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ConcreteImplementationB: Here\&#x27;s the result on the platform B.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Except for the initialization phase, where an Abstraction object gets linked</span></span><br><span class="line"><span class="comment"> * with a specific Implementation object, the client code should only depend on</span></span><br><span class="line"><span class="comment"> * the Abstraction class. This way the client code can support any abstraction-</span></span><br><span class="line"><span class="comment"> * implementation combination.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">abstraction: Abstraction</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(abstraction.operation());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code should be able to work with any pre-configured abstraction-</span></span><br><span class="line"><span class="comment"> * implementation combination.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> implementation = <span class="keyword">new</span> ConcreteImplementationA();</span><br><span class="line"><span class="keyword">let</span> abstraction = <span class="keyword">new</span> Abstraction(implementation);</span><br><span class="line">clientCode(abstraction);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">implementation = <span class="keyword">new</span> ConcreteImplementationB();</span><br><span class="line">abstraction = <span class="keyword">new</span> ExtendedAbstraction(implementation);</span><br><span class="line">clientCode(abstraction);</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Abstraction: Base operation <span class="keyword">with</span>:</span><br><span class="line">ConcreteImplementationA: Here<span class="string">&#x27;s the result on the platform A.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ExtendedAbstraction: Extended operation with:</span></span><br><span class="line"><span class="string">ConcreteImplementationB: Here&#x27;</span>s the result on the platform B.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>组合模式: 组合模式是一种结构型设计模式， 你可以使用它将对象组合成树状结构， 并且能像使用独立对象一样使用它们。</p>
<p>组合模式优缺点<br>  优点:</p>
<pre><code>  1.你可以利用多态和递归机制更方便地使用复杂树结构。
  2.开闭原则。 无需更改现有代码， 你就可以在应用中添加新元素， 使其成为对象树的一部分。</code></pre>
<p>  缺点:</p>
<pre><code>  1.对于功能差异较大的类， 提供公共接口或许会有困难。 在特定情况下， 你需要过度一般化组件接口， 使其变得令人难以理解。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The base Component class declares common operations for both simple and</span></span><br><span class="line"><span class="comment"> * complex objects of a composition.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Component &#123;</span><br><span class="line">    <span class="keyword">protected</span> parent: Component;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Optionally, the base Component can declare an interface for setting and</span></span><br><span class="line"><span class="comment">     * accessing a parent of the component in a tree structure. It can also</span></span><br><span class="line"><span class="comment">     * provide some default implementation for these methods.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> setParent(parent: Component) &#123;</span><br><span class="line">        <span class="built_in">this</span>.parent = parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getParent(): Component &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * In some cases, it would be beneficial to define the child-management</span></span><br><span class="line"><span class="comment">     * operations right in the base Component class. This way, you won&#x27;t need to</span></span><br><span class="line"><span class="comment">     * expose any concrete component classes to the client code, even during the</span></span><br><span class="line"><span class="comment">     * object tree assembly. The downside is that these methods will be empty</span></span><br><span class="line"><span class="comment">     * for the leaf-level components.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> add(component: Component): <span class="built_in">void</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> remove(component: Component): <span class="built_in">void</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * You can provide a method that lets the client code figure out whether a</span></span><br><span class="line"><span class="comment">     * component can bear children.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> isComposite(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * The base Component may implement some default behavior or leave it to</span></span><br><span class="line"><span class="comment">    * concrete classes (by declaring the method containing the behavior as</span></span><br><span class="line"><span class="comment">    * &quot;abstract&quot;).</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> operation(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Leaf class represents the end objects of a composition. A leaf can&#x27;t have</span></span><br><span class="line"><span class="comment">     * any children.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Usually, it&#x27;s the Leaf objects that do the actual work, whereas Composite</span></span><br><span class="line"><span class="comment">     * objects only delegate to their sub-components.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">class</span> Leaf <span class="keyword">extends</span> Component &#123;</span><br><span class="line">        <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Leaf&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Composite class represents the complex components that may have children.</span></span><br><span class="line"><span class="comment">     * Usually, the Composite objects delegate the actual work to their children and</span></span><br><span class="line"><span class="comment">     * then &quot;sum-up&quot; the result.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">class</span> Composite <span class="keyword">extends</span> Component &#123;</span><br><span class="line">        <span class="keyword">protected</span> children: Component[] = [];</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * A composite object can add or remove other components (both simple or</span></span><br><span class="line"><span class="comment">         * complex) to or from its child list.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> add(component: Component): <span class="built_in">void</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.children.push(component);</span><br><span class="line">            component.setParent(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> remove(component: Component): <span class="built_in">void</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> componentIndex = <span class="built_in">this</span>.children.indexOf(component);</span><br><span class="line">            <span class="built_in">this</span>.children.splice(componentIndex, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            component.setParent(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> isComposite(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * The Composite executes its primary logic in a particular way. It</span></span><br><span class="line"><span class="comment">         * traverses recursively through all its children, collecting and summing</span></span><br><span class="line"><span class="comment">         * their results. Since the composite&#x27;s children pass these calls to their</span></span><br><span class="line"><span class="comment">         * children and so forth, the whole object tree is traversed as a result.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> results = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> child <span class="keyword">of</span> <span class="built_in">this</span>.children) &#123;</span><br><span class="line">                results.push(child.operation());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="string">`Branch(<span class="subst">$&#123;results.join(<span class="string">&#x27;+&#x27;</span>)&#125;</span>)`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The client code works with all of the components via the base interface.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">component: Component</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`RESULT: <span class="subst">$&#123;component.operation()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This way the client code can support the simple leaf components...</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> simple = <span class="keyword">new</span> Leaf();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Client: I\&#x27;ve got a simple component:&#x27;</span>);</span><br><span class="line">    clientCode(simple);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ...as well as the complex composites.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> tree = <span class="keyword">new</span> Composite();</span><br><span class="line">    <span class="keyword">const</span> branch1 = <span class="keyword">new</span> Composite();</span><br><span class="line">    branch1.add(<span class="keyword">new</span> Leaf());</span><br><span class="line">    branch1.add(<span class="keyword">new</span> Leaf());</span><br><span class="line">    <span class="keyword">const</span> branch2 = <span class="keyword">new</span> Composite();</span><br><span class="line">    branch2.add(<span class="keyword">new</span> Leaf());</span><br><span class="line">    tree.add(branch1);</span><br><span class="line">    tree.add(branch2);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Client: Now I\&#x27;ve got a composite tree:&#x27;</span>);</span><br><span class="line">    clientCode(tree);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Thanks to the fact that the child-management operations are declared in the</span></span><br><span class="line"><span class="comment">     * base Component class, the client code can work with any component, simple or</span></span><br><span class="line"><span class="comment">     * complex, without depending on their concrete classes.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clientCode2</span>(<span class="params">component1: Component, component2: Component</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (component1.isComposite()) &#123;</span><br><span class="line">            component1.add(component2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`RESULT: <span class="subst">$&#123;component1.operation()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Client: I don\&#x27;t need to check the components classes even when managing the tree:&#x27;</span>);</span><br><span class="line">    clientCode2(tree, simple);</span><br><span class="line"></span><br><span class="line">    Output: 执行结果</span><br><span class="line">    Client: I<span class="string">&#x27;ve got a simple component:</span></span><br><span class="line"><span class="string">    RESULT: Leaf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Client: Now I&#x27;</span>ve got a composite tree:</span><br><span class="line">    RESULT: Branch(Branch(Leaf+Leaf)+Branch(Leaf))</span><br><span class="line"></span><br><span class="line">    Client: I don<span class="string">&#x27;t need to check the components classes even when managing the tree:</span></span><br><span class="line"><span class="string">    RESULT: Branch(Branch(Leaf+Leaf)+Branch(Leaf)+Leaf)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>装饰模式: 装饰模式是一种结构型设计模式， 允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为。</p>
<p>装饰模式优缺点:<br>  优点:</p>
<pre><code>  1.你无需创建新子类即可扩展对象的行为。
  2.你可以在运行时添加或删除对象的功能。
  3.你可以用多个装饰封装对象来组合几种行为。
  4.单一职责原则。 你可以将实现了许多不同行为的一个大类拆分为多个较小的类。</code></pre>
<p>  缺点:</p>
<pre><code>  1.在封装器栈中删除特定封装器比较困难。
  2.实现行为不受装饰栈顺序影响的装饰比较困难。
  3.各层的初始化配置代码看上去可能会很糟糕。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The base Component interface defines operations that can be altered by</span></span><br><span class="line"><span class="comment"> * decorators.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Component &#123;</span><br><span class="line">    operation(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Components provide default implementations of the operations. There</span></span><br><span class="line"><span class="comment"> * might be several variations of these classes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteComponent <span class="keyword">implements</span> Component &#123;</span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ConcreteComponent&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The base Decorator class follows the same interface as the other components.</span></span><br><span class="line"><span class="comment"> * The primary purpose of this class is to define the wrapping interface for all</span></span><br><span class="line"><span class="comment"> * concrete decorators. The default implementation of the wrapping code might</span></span><br><span class="line"><span class="comment"> * include a field for storing a wrapped component and the means to initialize</span></span><br><span class="line"><span class="comment"> * it.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Decorator <span class="keyword">implements</span> Component &#123;</span><br><span class="line">    <span class="keyword">protected</span> component: Component;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">component: Component</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.component = component;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Decorator delegates all work to the wrapped component.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.component.operation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Decorators call the wrapped object and alter its result in some way.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteDecoratorA <span class="keyword">extends</span> Decorator &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decorators may call parent implementation of the operation, instead of</span></span><br><span class="line"><span class="comment">     * calling the wrapped object directly. This approach simplifies extension</span></span><br><span class="line"><span class="comment">     * of decorator classes.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`ConcreteDecoratorA(<span class="subst">$&#123;<span class="built_in">super</span>.operation()&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Decorators can execute their behavior either before or after the call to a</span></span><br><span class="line"><span class="comment"> * wrapped object.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteDecoratorB <span class="keyword">extends</span> Decorator &#123;</span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`ConcreteDecoratorB(<span class="subst">$&#123;<span class="built_in">super</span>.operation()&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code works with all objects using the Component interface. This</span></span><br><span class="line"><span class="comment"> * way it can stay independent of the concrete classes of components it works</span></span><br><span class="line"><span class="comment"> * with.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">component: Component</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`RESULT: <span class="subst">$&#123;component.operation()&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This way the client code can support both simple components...</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> simple = <span class="keyword">new</span> ConcreteComponent();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: I\&#x27;ve got a simple component:&#x27;</span>);</span><br><span class="line">clientCode(simple);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ...as well as decorated ones.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Note how decorators can wrap not only simple components but the other</span></span><br><span class="line"><span class="comment"> * decorators as well.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> decorator1 = <span class="keyword">new</span> ConcreteDecoratorA(simple);</span><br><span class="line"><span class="keyword">const</span> decorator2 = <span class="keyword">new</span> ConcreteDecoratorB(decorator1);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Now I\&#x27;ve got a decorated component:&#x27;</span>);</span><br><span class="line">clientCode(decorator2);</span><br><span class="line">Output: 执行结果</span><br><span class="line">Client: I<span class="string">&#x27;ve got a simple component:</span></span><br><span class="line"><span class="string">RESULT: ConcreteComponent</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Client: Now I&#x27;</span>ve got a decorated component:</span><br><span class="line">RESULT: ConcreteDecoratorB(ConcreteDecoratorA(ConcreteComponent))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>外观模式: 外观模式是一种结构型设计模式， 能为程序库、 框架或其他复杂类提供一个简单的接口。</p>
<p>外观模式的优缺点:<br>  优点:</p>
<pre><code>  1. 你可以让自己的代码独立于复杂子系统。</code></pre>
<p>  缺点:</p>
<pre><code>   2.外观可能成为与程序中所有类都耦合的上帝对象。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Facade class provides a simple interface to the complex logic of one or</span></span><br><span class="line"><span class="comment"> * several subsystems. The Facade delegates the client requests to the</span></span><br><span class="line"><span class="comment"> * appropriate objects within the subsystem. The Facade is also responsible for</span></span><br><span class="line"><span class="comment"> * managing their lifecycle. All of this shields the client from the undesired</span></span><br><span class="line"><span class="comment"> * complexity of the subsystem.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Facade &#123;</span><br><span class="line">    <span class="keyword">protected</span> subsystem1: Subsystem1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> subsystem2: Subsystem2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Depending on your application&#x27;s needs, you can provide the Facade with</span></span><br><span class="line"><span class="comment">     * existing subsystem objects or force the Facade to create them on its own.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">subsystem1: Subsystem1 = <span class="literal">null</span>, subsystem2: Subsystem2 = <span class="literal">null</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.subsystem1 = subsystem1 || <span class="keyword">new</span> Subsystem1();</span><br><span class="line">        <span class="built_in">this</span>.subsystem2 = subsystem2 || <span class="keyword">new</span> Subsystem2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Facade&#x27;s methods are convenient shortcuts to the sophisticated</span></span><br><span class="line"><span class="comment">     * functionality of the subsystems. However, clients get only to a fraction</span></span><br><span class="line"><span class="comment">     * of a subsystem&#x27;s capabilities.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> operation(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> result = <span class="string">&#x27;Facade initializes subsystems:\n&#x27;</span>;</span><br><span class="line">        result += <span class="built_in">this</span>.subsystem1.operation1();</span><br><span class="line">        result += <span class="built_in">this</span>.subsystem2.operation1();</span><br><span class="line">        result += <span class="string">&#x27;Facade orders subsystems to perform the action:\n&#x27;</span>;</span><br><span class="line">        result += <span class="built_in">this</span>.subsystem1.operationN();</span><br><span class="line">        result += <span class="built_in">this</span>.subsystem2.operationZ();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Subsystem can accept requests either from the facade or client directly.</span></span><br><span class="line"><span class="comment"> * In any case, to the Subsystem, the Facade is yet another client, and it&#x27;s not</span></span><br><span class="line"><span class="comment"> * a part of the Subsystem.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Subsystem1 &#123;</span><br><span class="line">    <span class="keyword">public</span> operation1(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Subsystem1: Ready!\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> operationN(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Subsystem1: Go!\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Some facades can work with multiple subsystems at the same time.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Subsystem2 &#123;</span><br><span class="line">    <span class="keyword">public</span> operation1(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Subsystem2: Get ready!\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> operationZ(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Subsystem2: Fire!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code works with complex subsystems through a simple interface</span></span><br><span class="line"><span class="comment"> * provided by the Facade. When a facade manages the lifecycle of the subsystem,</span></span><br><span class="line"><span class="comment"> * the client might not even know about the existence of the subsystem. This</span></span><br><span class="line"><span class="comment"> * approach lets you keep the complexity under control.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">facade: Facade</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(facade.operation());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code may have some of the subsystem&#x27;s objects already created. In</span></span><br><span class="line"><span class="comment"> * this case, it might be worthwhile to initialize the Facade with these objects</span></span><br><span class="line"><span class="comment"> * instead of letting the Facade create new instances.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> subsystem1 = <span class="keyword">new</span> Subsystem1();</span><br><span class="line"><span class="keyword">const</span> subsystem2 = <span class="keyword">new</span> Subsystem2();</span><br><span class="line"><span class="keyword">const</span> facade = <span class="keyword">new</span> Facade(subsystem1, subsystem2);</span><br><span class="line">clientCode(facade);</span><br><span class="line">Output: 执行结果</span><br><span class="line">Facade initializes subsystems:</span><br><span class="line">Subsystem1: Ready!</span><br><span class="line">Subsystem2: Get ready!</span><br><span class="line">Facade orders subsystems to perform the action:</span><br><span class="line">Subsystem1: Go!</span><br><span class="line">Subsystem2: Fire!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>享元模式: 享元模式是一种结构型设计模式， 它摒弃了在每个对象中保存所有数据的方式， 通过共享多个对象所共有的相同状态， 让你能在有限的内存容量中载入更多对象。</p>
<p>享元模式的优缺点:<br>  优点:</p>
<pre><code>  1. 如果程序中有很多相似对象， 那么你将可以节省大量内存。</code></pre>
<p>  缺点:</p>
<pre><code>  1. 你可能需要牺牲执行速度来换取内存， 因为他人每次调用享元方法时都需要重新计算部分情景数据。
  2. 代码会变得更加复杂。 团队中的新成员总是会问： ​ “为什么要像这样拆分一个实体的状态？”。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Flyweight stores a common portion of the state (also called intrinsic</span></span><br><span class="line"><span class="comment"> * state) that belongs to multiple real business entities. The Flyweight accepts</span></span><br><span class="line"><span class="comment"> * the rest of the state (extrinsic state, unique for each entity) via its</span></span><br><span class="line"><span class="comment"> * method parameters.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Flyweight &#123;</span><br><span class="line">    <span class="keyword">private</span> sharedState: <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">sharedState: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.sharedState = sharedState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> operation(uniqueState): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> s = <span class="built_in">JSON</span>.stringify(<span class="built_in">this</span>.sharedState);</span><br><span class="line">        <span class="keyword">const</span> u = <span class="built_in">JSON</span>.stringify(uniqueState);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Flyweight: Displaying shared (<span class="subst">$&#123;s&#125;</span>) and unique (<span class="subst">$&#123;u&#125;</span>) state.`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Flyweight Factory creates and manages the Flyweight objects. It ensures</span></span><br><span class="line"><span class="comment"> * that flyweights are shared correctly. When the client requests a flyweight,</span></span><br><span class="line"><span class="comment"> * the factory either returns an existing instance or creates a new one, if it</span></span><br><span class="line"><span class="comment"> * doesn&#x27;t exist yet.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> FlyweightFactory &#123;</span><br><span class="line">    <span class="keyword">private</span> flyweights: &#123;[key: <span class="built_in">string</span>]: Flyweight&#125; = &lt;<span class="built_in">any</span>&gt;&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">initialFlyweights: <span class="built_in">string</span>[][]</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> state <span class="keyword">of</span> initialFlyweights) &#123;</span><br><span class="line">            <span class="built_in">this</span>.flyweights[<span class="built_in">this</span>.getKey(state)] = <span class="keyword">new</span> Flyweight(state);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a Flyweight&#x27;s string hash for a given state.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> getKey(state: <span class="built_in">string</span>[]): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> state.join(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an existing Flyweight with a given state or creates a new one.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> getFlyweight(sharedState: <span class="built_in">string</span>[]): Flyweight &#123;</span><br><span class="line">        <span class="keyword">const</span> key = <span class="built_in">this</span>.getKey(sharedState);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!(key <span class="keyword">in</span> <span class="built_in">this</span>.flyweights)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;FlyweightFactory: Can\&#x27;t find a flyweight, creating new one.&#x27;</span>);</span><br><span class="line">            <span class="built_in">this</span>.flyweights[key] = <span class="keyword">new</span> Flyweight(sharedState);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;FlyweightFactory: Reusing existing flyweight.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.flyweights[key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> listFlyweights(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> count = <span class="built_in">Object</span>.keys(<span class="built_in">this</span>.flyweights).length;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`\nFlyweightFactory: I have <span class="subst">$&#123;count&#125;</span> flyweights:`</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> <span class="built_in">this</span>.flyweights) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The client code usually creates a bunch of pre-populated flyweights in the</span></span><br><span class="line"><span class="comment">* initialization stage of the application.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> factory = <span class="keyword">new</span> FlyweightFactory([</span><br><span class="line">    [<span class="string">&#x27;Chevrolet&#x27;</span>, <span class="string">&#x27;Camaro2018&#x27;</span>, <span class="string">&#x27;pink&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;Mercedes Benz&#x27;</span>, <span class="string">&#x27;C300&#x27;</span>, <span class="string">&#x27;black&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;Mercedes Benz&#x27;</span>, <span class="string">&#x27;C500&#x27;</span>, <span class="string">&#x27;red&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;BMW&#x27;</span>, <span class="string">&#x27;M5&#x27;</span>, <span class="string">&#x27;red&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;BMW&#x27;</span>, <span class="string">&#x27;X6&#x27;</span>, <span class="string">&#x27;white&#x27;</span>],</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">]);</span><br><span class="line">factory.listFlyweights();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addCarToPoliceDatabase</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    ff: FlyweightFactory, plates: <span class="built_in">string</span>, owner: <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    brand: <span class="built_in">string</span>, model: <span class="built_in">string</span>, color: <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;\nClient: Adding a car to database.&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> flyweight = ff.getFlyweight([brand, model, color]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The client code either stores or calculates extrinsic state and passes it</span></span><br><span class="line">    <span class="comment">// to the flyweight&#x27;s methods.</span></span><br><span class="line">    flyweight.operation([plates, owner]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">addCarToPoliceDatabase(factory, <span class="string">&#x27;CL234IR&#x27;</span>, <span class="string">&#x27;James Doe&#x27;</span>, <span class="string">&#x27;BMW&#x27;</span>, <span class="string">&#x27;M5&#x27;</span>, <span class="string">&#x27;red&#x27;</span>);</span><br><span class="line"></span><br><span class="line">addCarToPoliceDatabase(factory, <span class="string">&#x27;CL234IR&#x27;</span>, <span class="string">&#x27;James Doe&#x27;</span>, <span class="string">&#x27;BMW&#x27;</span>, <span class="string">&#x27;X1&#x27;</span>, <span class="string">&#x27;red&#x27;</span>);</span><br><span class="line"></span><br><span class="line">factory.listFlyweights();</span><br><span class="line">Output: 执行结果</span><br><span class="line">FlyweightFactory: I have <span class="number">5</span> flyweights:</span><br><span class="line">Chevrolet_Camaro2018_pink</span><br><span class="line">Mercedes Benz_C300_black</span><br><span class="line">Mercedes Benz_C500_red</span><br><span class="line">BMW_M5_red</span><br><span class="line">BMW_X6_white</span><br><span class="line"></span><br><span class="line">Client: Adding a car to database.</span><br><span class="line">FlyweightFactory: Reusing existing flyweight.</span><br><span class="line">Flyweight: Displaying shared ([<span class="string">&quot;BMW&quot;</span>,<span class="string">&quot;M5&quot;</span>,<span class="string">&quot;red&quot;</span>]) and unique ([<span class="string">&quot;CL234IR&quot;</span>,<span class="string">&quot;James Doe&quot;</span>]) state.</span><br><span class="line"></span><br><span class="line">Client: Adding a car to database.</span><br><span class="line">FlyweightFactory: Can<span class="string">&#x27;t find a flyweight, creating new one.</span></span><br><span class="line"><span class="string">Flyweight: Displaying shared ([&quot;BMW&quot;,&quot;X1&quot;,&quot;red&quot;]) and unique ([&quot;CL234IR&quot;,&quot;James Doe&quot;]) state.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">FlyweightFactory: I have 6 flyweights:</span></span><br><span class="line"><span class="string">Chevrolet_Camaro2018_pink</span></span><br><span class="line"><span class="string">Mercedes Benz_C300_black</span></span><br><span class="line"><span class="string">Mercedes Benz_C500_red</span></span><br><span class="line"><span class="string">BMW_M5_red</span></span><br><span class="line"><span class="string">BMW_X6_white</span></span><br><span class="line"><span class="string">BMW_X1_red</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>代理模式: 代理模式是一种结构型设计模式， 让你能够提供对象的替代品或其占位符。 代理控制着对于原对象的访问， 并允许在将请求提交给对象前后进行一些处理。</p>
<p>代理模式优缺点:<br>  优点:</p>
<pre><code>  1.你可以在客户端毫无察觉的情况下控制服务对象。
  2.如果客户端对服务对象的生命周期没有特殊要求， 你可以对生命周期进行管理。
  3.4.即使服务对象还未准备好或不存在， 代理也可以正常工作。
  开闭原则。 你可以在不对服务或客户端做出修改的情况下创建新代理。</code></pre>
<p>  缺点:</p>
<pre><code>  1.代码可能会变得复杂， 因为需要新建许多类。
  2.服务响应可能会延迟。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Subject interface declares common operations for both RealSubject and the</span></span><br><span class="line"><span class="comment"> * Proxy. As long as the client works with RealSubject using this interface,</span></span><br><span class="line"><span class="comment"> * you&#x27;ll be able to pass it a proxy instead of a real subject.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Subject &#123;</span><br><span class="line">    request(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The RealSubject contains some core business logic. Usually, RealSubjects are</span></span><br><span class="line"><span class="comment"> * capable of doing some useful work which may also be very slow or sensitive -</span></span><br><span class="line"><span class="comment"> * e.g. correcting input data. A Proxy can solve these issues without any</span></span><br><span class="line"><span class="comment"> * changes to the RealSubject&#x27;s code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> RealSubject <span class="keyword">implements</span> Subject &#123;</span><br><span class="line">    <span class="keyword">public</span> request(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;RealSubject: Handling request.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Proxy has an interface identical to the RealSubject.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="built_in">Proxy</span> <span class="keyword">implements</span> Subject &#123;</span><br><span class="line">    <span class="keyword">private</span> realSubject: RealSubject;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Proxy maintains a reference to an object of the RealSubject class. It</span></span><br><span class="line"><span class="comment">     * can be either lazy-loaded or passed to the Proxy by the client.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">realSubject: RealSubject</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.realSubject = realSubject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The most common applications of the Proxy pattern are lazy loading,</span></span><br><span class="line"><span class="comment">     * caching, controlling the access, logging, etc. A Proxy can perform one of</span></span><br><span class="line"><span class="comment">     * these things and then, depending on the result, pass the execution to the</span></span><br><span class="line"><span class="comment">     * same method in a linked RealSubject object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> request(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.checkAccess()) &#123;</span><br><span class="line">            <span class="built_in">this</span>.realSubject.request();</span><br><span class="line">            <span class="built_in">this</span>.logAccess();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> checkAccess(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">        <span class="comment">// Some real checks should go here.</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Proxy: Checking access prior to firing a real request.&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> logAccess(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Proxy: Logging the time of request.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code is supposed to work with all objects (both subjects and</span></span><br><span class="line"><span class="comment"> * proxies) via the Subject interface in order to support both real subjects and</span></span><br><span class="line"><span class="comment"> * proxies. In real life, however, clients mostly work with their real subjects</span></span><br><span class="line"><span class="comment"> * directly. In this case, to implement the pattern more easily, you can extend</span></span><br><span class="line"><span class="comment"> * your proxy from the real subject&#x27;s class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">subject: Subject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    subject.request();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Executing the client code with a real subject:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> realSubject = <span class="keyword">new</span> RealSubject();</span><br><span class="line">clientCode(realSubject);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Executing the same client code with a proxy:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(realSubject);</span><br><span class="line">clientCode(proxy);</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Client: Executing the client code <span class="keyword">with</span> a real subject:</span><br><span class="line">RealSubject: Handling request.</span><br><span class="line"></span><br><span class="line">Client: Executing the same client code <span class="keyword">with</span> a proxy:</span><br><span class="line"><span class="built_in">Proxy</span>: Checking access prior to firing a real request.</span><br><span class="line">RealSubject: Handling request.</span><br><span class="line"><span class="built_in">Proxy</span>: Logging the time <span class="keyword">of</span> request.</span><br></pre></td></tr></table></figure>

<h3 id="行为模式"><a href="#行为模式" class="headerlink" title="行为模式"></a>行为模式</h3><ul>
<li><p>责任链模式: 责任链模式是一种行为设计模式， 允许你将请求沿着处理者链进行发送。 收到请求后， 每个处理者均可对请求进行处理， 或将其传递给链上的下个处理者。</p>
<p>责任链模式优缺点:<br>  优点:</p>
<pre><code>  1.你可以控制请求处理的顺序。
  2.单一职责原则。 你可对发起操作和执行操作的类进行解耦。
  3.开闭原则。 你可以在不更改现有代码的情况下在程序中新增处理者。</code></pre>
<p>  缺点:</p>
<pre><code>  1. 部分请求可能未被处理。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Handler interface declares a method for building the chain of handlers.</span></span><br><span class="line"><span class="comment"> * It also declares a method for executing a request.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Handler &#123;</span><br><span class="line">    setNext(handler: Handler): Handler;</span><br><span class="line"></span><br><span class="line">    handle(request: <span class="built_in">string</span>): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The default chaining behavior can be implemented inside a base handler class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> AbstractHandler <span class="keyword">implements</span> Handler</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> nextHandler: Handler;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> setNext(handler: Handler): Handler &#123;</span><br><span class="line">        <span class="built_in">this</span>.nextHandler = handler;</span><br><span class="line">        <span class="comment">// Returning a handler from here will let us link handlers in a</span></span><br><span class="line">        <span class="comment">// convenient way like this:</span></span><br><span class="line">        <span class="comment">// monkey.setNext(squirrel).setNext(dog);</span></span><br><span class="line">        <span class="keyword">return</span> handler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> handle(request: <span class="built_in">string</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.nextHandler) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.nextHandler.handle(request);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * All Concrete Handlers either handle a request or pass it to the next handler</span></span><br><span class="line"><span class="comment"> * in the chain.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> MonkeyHandler <span class="keyword">extends</span> AbstractHandler &#123;</span><br><span class="line">    <span class="keyword">public</span> handle(request: <span class="built_in">string</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (request === <span class="string">&#x27;Banana&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`Monkey: I&#x27;ll eat the <span class="subst">$&#123;request&#125;</span>.`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.handle(request);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> SquirrelHandler <span class="keyword">extends</span> AbstractHandler &#123;</span><br><span class="line">    <span class="keyword">public</span> handle(request: <span class="built_in">string</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (request === <span class="string">&#x27;Nut&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`Squirrel: I&#x27;ll eat the <span class="subst">$&#123;request&#125;</span>.`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.handle(request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> DogHandler <span class="keyword">extends</span> AbstractHandler &#123;</span><br><span class="line">    <span class="keyword">public</span> handle(request: <span class="built_in">string</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (request === <span class="string">&#x27;MeatBall&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`Dog: I&#x27;ll eat the <span class="subst">$&#123;request&#125;</span>.`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.handle(request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code is usually suited to work with a single handler. In most</span></span><br><span class="line"><span class="comment"> * cases, it is not even aware that the handler is part of a chain.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">handler: Handler</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> foods = [<span class="string">&#x27;Nut&#x27;</span>, <span class="string">&#x27;Banana&#x27;</span>, <span class="string">&#x27;Cup of coffee&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> food <span class="keyword">of</span> foods) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Client: Who wants a <span class="subst">$&#123;food&#125;</span>?`</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> result = handler.handle(food);</span><br><span class="line">        <span class="keyword">if</span> (result) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`  <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`  <span class="subst">$&#123;food&#125;</span> was left untouched.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The other part of the client code constructs the actual chain.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> monkey = <span class="keyword">new</span> MonkeyHandler();</span><br><span class="line"><span class="keyword">const</span> squirrel = <span class="keyword">new</span> SquirrelHandler();</span><br><span class="line"><span class="keyword">const</span> dog = <span class="keyword">new</span> DogHandler();</span><br><span class="line"></span><br><span class="line">monkey.setNext(squirrel).setNext(dog);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client should be able to send a request to any handler, not just the</span></span><br><span class="line"><span class="comment"> * first one in the chain.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Chain: Monkey &gt; Squirrel &gt; Dog\n&#x27;</span>);</span><br><span class="line">clientCode(monkey);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Subchain: Squirrel &gt; Dog\n&#x27;</span>);</span><br><span class="line">clientCode(squirrel);</span><br><span class="line"></span><br><span class="line">Output.: 执行结果</span><br><span class="line">Chain: Monkey &gt; Squirrel &gt; Dog</span><br><span class="line"></span><br><span class="line">Client: Who wants a Nut?</span><br><span class="line">Squirrel: I<span class="string">&#x27;ll eat the Nut.</span></span><br><span class="line"><span class="string">Client: Who wants a Banana?</span></span><br><span class="line"><span class="string">Monkey: I&#x27;</span>ll eat the Banana.</span><br><span class="line">Client: Who wants a Cup <span class="keyword">of</span> coffee?</span><br><span class="line">Cup <span class="keyword">of</span> coffee was left untouched.</span><br><span class="line"></span><br><span class="line">Subchain: Squirrel &gt; Dog</span><br><span class="line"></span><br><span class="line">Client: Who wants a Nut?</span><br><span class="line">Squirrel: I<span class="string">&#x27;ll eat the Nut.</span></span><br><span class="line"><span class="string">Client: Who wants a Banana?</span></span><br><span class="line"><span class="string">Banana was left untouched.</span></span><br><span class="line"><span class="string">Client: Who wants a Cup of coffee?</span></span><br><span class="line"><span class="string">Cup of coffee was left untouched.</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>命令模式: 命令模式是一种行为设计模式， 它可将请求转换为一个包含与请求相关的所有信息的独立对象。 该转换让你能根据不同的请求将方法参数化、 延迟请求执行或将其放入队列中， 且能实现可撤销操作。</p>
<p>命令模式优缺点:<br>  优点:</p>
<pre><code>1. 单一职责原则。 你可以解耦触发和执行操作的类。
2. 开闭原则。 你可以在不修改已有客户端代码的情况下在程序中创建新的命令。
3. 你可以实现撤销和恢复功能。
4. 你可以实现操作的延迟执行。
5. 你可以将一组简单命令组合成一个复杂命令。</code></pre>
<p> 缺点:</p>
<pre><code>1. 代码可能会变得更加复杂， 因为你在发送者和接收者之间增加了一个全新的层次。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Command interface declares a method for executing a command.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Command &#123;</span><br><span class="line">    execute(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Some commands can implement simple operations on their own.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> SimpleCommand <span class="keyword">implements</span> Command &#123;</span><br><span class="line">    <span class="keyword">private</span> payload: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">payload: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.payload = payload;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> execute(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`SimpleCommand: See, I can do simple things like printing (<span class="subst">$&#123;<span class="built_in">this</span>.payload&#125;</span>)`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * However, some commands can delegate more complex operations to other objects,</span></span><br><span class="line"><span class="comment"> * called &quot;receivers.&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ComplexCommand <span class="keyword">implements</span> Command &#123;</span><br><span class="line">    <span class="keyword">private</span> receiver: Receiver;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Context data, required for launching the receiver&#x27;s methods.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> a: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> b: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Complex commands can accept one or several receiver objects along with</span></span><br><span class="line"><span class="comment">     * any context data via the constructor.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">receiver: Receiver, a: <span class="built_in">string</span>, b: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.receiver = receiver;</span><br><span class="line">        <span class="built_in">this</span>.a = a;</span><br><span class="line">        <span class="built_in">this</span>.b = b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Commands can delegate to any methods of a receiver.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> execute(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ComplexCommand: Complex stuff should be done by a receiver object.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.receiver.doSomething(<span class="built_in">this</span>.a);</span><br><span class="line">        <span class="built_in">this</span>.receiver.doSomethingElse(<span class="built_in">this</span>.b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Receiver classes contain some important business logic. They know how to</span></span><br><span class="line"><span class="comment"> * perform all kinds of operations, associated with carrying out a request. In</span></span><br><span class="line"><span class="comment"> * fact, any class may serve as a Receiver.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Receiver &#123;</span><br><span class="line">    <span class="keyword">public</span> doSomething(a: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Receiver: Working on (<span class="subst">$&#123;a&#125;</span>.)`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> doSomethingElse(b: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Receiver: Also working on (<span class="subst">$&#123;b&#125;</span>.)`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Invoker is associated with one or several commands. It sends a request to</span></span><br><span class="line"><span class="comment"> * the command.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Invoker &#123;</span><br><span class="line">    <span class="keyword">private</span> onStart: Command;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> onFinish: Command;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Initialize commands.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> setOnStart(command: Command): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.onStart = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> setOnFinish(command: Command): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.onFinish = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Invoker does not depend on concrete command or receiver classes. The</span></span><br><span class="line"><span class="comment">     * Invoker passes a request to a receiver indirectly, by executing a</span></span><br><span class="line"><span class="comment">     * command.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> doSomethingImportant(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Invoker: Does anybody want something done before I begin?&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.isCommand(<span class="built_in">this</span>.onStart)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.onStart.execute();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Invoker: ...doing something really important...&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Invoker: Does anybody want something done after I finish?&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.isCommand(<span class="built_in">this</span>.onFinish)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.onFinish.execute();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> isCommand(<span class="built_in">object</span>): <span class="built_in">object</span> is Command &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">object</span>.execute !== <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code can parameterize an invoker with any commands.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">invoker.setOnStart(<span class="keyword">new</span> SimpleCommand(<span class="string">&#x27;Say Hi!&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">invoker.setOnFinish(<span class="keyword">new</span> ComplexCommand(receiver, <span class="string">&#x27;Send email&#x27;</span>, <span class="string">&#x27;Save report&#x27;</span>));</span><br><span class="line"></span><br><span class="line">invoker.doSomethingImportant();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Invoker: Does anybody want something done before I begin?</span><br><span class="line">SimpleCommand: See, I can <span class="keyword">do</span> simple things like printing (Say Hi!)</span><br><span class="line">Invoker: ...doing something really important...</span><br><span class="line">Invoker: Does anybody want something done after I finish?</span><br><span class="line">ComplexCommand: Complex stuff should be done by a receiver <span class="built_in">object</span>.</span><br><span class="line">Receiver: Working on (Send email.)</span><br><span class="line">Receiver: Also working on (Save report.)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>迭代器模式: 迭代器模式是一种行为设计模式， 让你能在不暴露集合底层表现形式 （列表、 栈和树等） 的情况下遍历集合中所有的元素。</p>
<p>迭代器模式优缺点:<br>  优点:</p>
<pre><code>1. 单一职责原则。 通过将体积庞大的遍历算法代码抽取为独立的类， 你可对客户端代码和集合进行整理。
2. 开闭原则。 你可实现新型的集合和迭代器并将其传递给现有代码， 无需修改现有代码。
3. 你可以并行遍历同一集合， 因为每个迭代器对象都包含其自身的遍历状态。
4. 相似的， 你可以暂停遍历并在需要时继续。</code></pre>
<p> 缺点:</p>
<pre><code>1. 如果你的程序只与简单的集合进行交互， 应用该模式可能会矫枉过正。
2. 对于某些特殊集合， 使用迭代器可能比直接遍历的效率低。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Iterator Design Pattern</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Intent: Lets you traverse elements of a collection without exposing its</span></span><br><span class="line"><span class="comment"> * underlying representation (list, stack, tree, etc.).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Iterator&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">// Return the current element.</span></span><br><span class="line">    current(): T;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the current element and move forward to next element.</span></span><br><span class="line">    next(): T;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the key of the current element.</span></span><br><span class="line">    key(): <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Checks if current position is valid.</span></span><br><span class="line">    valid(): <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rewind the Iterator to the first element.</span></span><br><span class="line">    rewind(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Aggregator &#123;</span><br><span class="line">    <span class="comment">// Retrieve an external iterator.</span></span><br><span class="line">    getIterator(): Iterator&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Iterators implement various traversal algorithms. These classes</span></span><br><span class="line"><span class="comment"> * store the current traversal position at all times.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> AlphabeticalOrderIterator <span class="keyword">implements</span> Iterator&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> collection: WordsCollection;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Stores the current traversal position. An iterator may have a lot of</span></span><br><span class="line"><span class="comment">     * other fields for storing iteration state, especially when it is supposed</span></span><br><span class="line"><span class="comment">     * to work with a particular kind of collection.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> position: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This variable indicates the traversal direction.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> reverse: <span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">collection: WordsCollection, reverse: <span class="built_in">boolean</span> = <span class="literal">false</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.collection = collection;</span><br><span class="line">        <span class="built_in">this</span>.reverse = reverse;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (reverse) &#123;</span><br><span class="line">            <span class="built_in">this</span>.position = collection.getCount() - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> rewind() &#123;</span><br><span class="line">        <span class="built_in">this</span>.position = <span class="built_in">this</span>.reverse ?</span><br><span class="line">            <span class="built_in">this</span>.collection.getCount() - <span class="number">1</span> :</span><br><span class="line">            <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> current(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.collection.getItems()[<span class="built_in">this</span>.position];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> key(): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> next(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> item = <span class="built_in">this</span>.collection.getItems()[<span class="built_in">this</span>.position];</span><br><span class="line">        <span class="built_in">this</span>.position += <span class="built_in">this</span>.reverse ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> valid(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.reverse) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.position &gt;= <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.position &lt; <span class="built_in">this</span>.collection.getCount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Collections provide one or several methods for retrieving fresh</span></span><br><span class="line"><span class="comment"> * iterator instances, compatible with the collection class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> WordsCollection <span class="keyword">implements</span> Aggregator &#123;</span><br><span class="line">    <span class="keyword">private</span> items: <span class="built_in">string</span>[] = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getItems(): <span class="built_in">string</span>[] &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getCount(): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> addItem(item: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.items.push(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getIterator(): Iterator&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AlphabeticalOrderIterator(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getReverseIterator(): Iterator&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AlphabeticalOrderIterator(<span class="built_in">this</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code may or may not know about the Concrete Iterator or Collection</span></span><br><span class="line"><span class="comment"> * classes, depending on the level of indirection you want to keep in your</span></span><br><span class="line"><span class="comment"> * program.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> collection = <span class="keyword">new</span> WordsCollection();</span><br><span class="line">collection.addItem(<span class="string">&#x27;First&#x27;</span>);</span><br><span class="line">collection.addItem(<span class="string">&#x27;Second&#x27;</span>);</span><br><span class="line">collection.addItem(<span class="string">&#x27;Third&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> iterator = collection.getIterator();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Straight traversal:&#x27;</span>);</span><br><span class="line"><span class="keyword">while</span> (iterator.valid()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(iterator.next());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Reverse traversal:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> reverseIterator = collection.getReverseIterator();</span><br><span class="line"><span class="keyword">while</span> (reverseIterator.valid()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(reverseIterator.next());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Straight traversal:</span><br><span class="line">First</span><br><span class="line">Second</span><br><span class="line">Third</span><br><span class="line"></span><br><span class="line">Reverse traversal:</span><br><span class="line">Third</span><br><span class="line">Second</span><br><span class="line">First</span><br></pre></td></tr></table></figure>

<ul>
<li><p>中介者模式: 中介者模式是一种行为设计模式， 能让你减少对象之间混乱无序的依赖关系。 该模式会限制对象之间的直接交互， 迫使它们通过一个中介者对象进行合作。</p>
<p>中介者模式优缺点:<br>  优点:</p>
<pre><code>1. 单一职责原则。 你可以将多个组件间的交流抽取到同一位置， 使其更易于理解和维护。
2. 开闭原则。 你无需修改实际组件就能增加新的中介者。
3. 你可以减轻应用中多个组件间的耦合情况。
4. 你可以更方便地复用各个组件。</code></pre>
<p>  缺点:</p>
<pre><code>1. 一段时间后， 中介者可能会演化成为上帝对象。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Mediator interface declares a method used by components to notify the</span></span><br><span class="line"><span class="comment"> * mediator about various events. The Mediator may react to these events and</span></span><br><span class="line"><span class="comment"> * pass the execution to other components.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Mediator &#123;</span><br><span class="line">    notify(sender: <span class="built_in">object</span>, event: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Mediators implement cooperative behavior by coordinating several</span></span><br><span class="line"><span class="comment"> * components.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteMediator <span class="keyword">implements</span> Mediator &#123;</span><br><span class="line">    <span class="keyword">private</span> component1: Component1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> component2: Component2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">c1: Component1, c2: Component2</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.component1 = c1;</span><br><span class="line">        <span class="built_in">this</span>.component1.setMediator(<span class="built_in">this</span>);</span><br><span class="line">        <span class="built_in">this</span>.component2 = c2;</span><br><span class="line">        <span class="built_in">this</span>.component2.setMediator(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> notify(sender: <span class="built_in">object</span>, event: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (event === <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;Mediator reacts on A and triggers following operations:&#x27;</span>);</span><br><span class="line">            <span class="built_in">this</span>.component2.doC();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (event === <span class="string">&#x27;D&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;Mediator reacts on D and triggers following operations:&#x27;</span>);</span><br><span class="line">            <span class="built_in">this</span>.component1.doB();</span><br><span class="line">            <span class="built_in">this</span>.component2.doC();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Base Component provides the basic functionality of storing a mediator&#x27;s</span></span><br><span class="line"><span class="comment"> * instance inside component objects.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> BaseComponent &#123;</span><br><span class="line">    <span class="keyword">protected</span> mediator: Mediator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">mediator: Mediator = <span class="literal">null</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> setMediator(mediator: Mediator): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Components implement various functionality. They don&#x27;t depend on</span></span><br><span class="line"><span class="comment"> * other components. They also don&#x27;t depend on any concrete mediator classes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Component1 <span class="keyword">extends</span> BaseComponent &#123;</span><br><span class="line">    <span class="keyword">public</span> doA(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component 1 does A.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.mediator.notify(<span class="built_in">this</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> doB(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component 1 does B.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.mediator.notify(<span class="built_in">this</span>, <span class="string">&#x27;B&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Component2 <span class="keyword">extends</span> BaseComponent &#123;</span><br><span class="line">    <span class="keyword">public</span> doC(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component 2 does C.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.mediator.notify(<span class="built_in">this</span>, <span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> doD(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Component 2 does D.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.mediator.notify(<span class="built_in">this</span>, <span class="string">&#x27;D&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> c1 = <span class="keyword">new</span> Component1();</span><br><span class="line"><span class="keyword">const</span> c2 = <span class="keyword">new</span> Component2();</span><br><span class="line"><span class="keyword">const</span> mediator = <span class="keyword">new</span> ConcreteMediator(c1, c2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client triggers operation A.&#x27;</span>);</span><br><span class="line">c1.doA();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client triggers operation D.&#x27;</span>);</span><br><span class="line">c2.doD();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Client triggers operation A.</span><br><span class="line">Component <span class="number">1</span> does A.</span><br><span class="line">Mediator reacts on A and triggers following operations:</span><br><span class="line">Component <span class="number">2</span> does C.</span><br><span class="line"></span><br><span class="line">Client triggers operation D.</span><br><span class="line">Component <span class="number">2</span> does D.</span><br><span class="line">Mediator reacts on D and triggers following operations:</span><br><span class="line">Component <span class="number">1</span> does B.</span><br><span class="line">Component <span class="number">2</span> does C.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>备忘录模式: 备忘录模式是一种行为设计模式， 允许在不暴露对象实现细节的情况下保存和恢复对象之前的状态。</p>
<p> 备忘录模式优缺点<br>  优点:</p>
<pre><code>1. 你可以在不破坏对象封装情况的前提下创建对象状态快照。
2. 你可以通过让负责人维护原发器状态历史记录来简化原发器代码。</code></pre>
<p> 缺点:</p>
<pre><code>1. 如果客户端过于频繁地创建备忘录， 程序将消耗大量内存。
2. 负责人必须完整跟踪原发器的生命周期， 这样才能销毁弃用的备忘录。
3. 绝大部分动态编程语言 （例如 PHP、 Python 和 JavaScript） 不能确保备忘录中的状态不被修改。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Originator holds some important state that may change over time. It also</span></span><br><span class="line"><span class="comment"> * defines a method for saving the state inside a memento and another method for</span></span><br><span class="line"><span class="comment"> * restoring the state from it.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Originator &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * For the sake of simplicity, the originator&#x27;s state is stored inside a</span></span><br><span class="line"><span class="comment">     * single variable.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> state: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">state: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.state = state;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Originator: My initial state is: <span class="subst">$&#123;state&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Originator&#x27;s business logic may affect its internal state. Therefore,</span></span><br><span class="line"><span class="comment">     * the client should backup the state before launching methods of the</span></span><br><span class="line"><span class="comment">     * business logic via the save() method.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> doSomething(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Originator: I\&#x27;m doing something important.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.state = <span class="built_in">this</span>.generateRandomString(<span class="number">30</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Originator: and my state has changed to: <span class="subst">$&#123;<span class="built_in">this</span>.state&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> generateRandomString(length: <span class="built_in">number</span> = <span class="number">10</span>): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> charSet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Array</span></span><br><span class="line">            .apply(<span class="literal">null</span>, &#123; length &#125;)</span><br><span class="line">            .map(<span class="function">() =&gt;</span> charSet.charAt(<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * charSet.length)))</span><br><span class="line">            .join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Saves the current state inside a memento.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> save(): Memento &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteMemento(<span class="built_in">this</span>.state);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Restores the Originator&#x27;s state from a memento object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> restore(memento: Memento): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.state = memento.getState();</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Originator: My state has changed to: <span class="subst">$&#123;<span class="built_in">this</span>.state&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Memento interface provides a way to retrieve the memento&#x27;s metadata, such</span></span><br><span class="line"><span class="comment"> * as creation date or name. However, it doesn&#x27;t expose the Originator&#x27;s state.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Memento &#123;</span><br><span class="line">    getState(): <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    getName(): <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    getDate(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Concrete Memento contains the infrastructure for storing the Originator&#x27;s</span></span><br><span class="line"><span class="comment"> * state.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteMemento <span class="keyword">implements</span> Memento &#123;</span><br><span class="line">    <span class="keyword">private</span> state: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> date: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">state: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.state = state;</span><br><span class="line">        <span class="built_in">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString().slice(<span class="number">0</span>, <span class="number">19</span>).replace(<span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Originator uses this method when restoring its state.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> getState(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The rest of the methods are used by the Caretaker to display metadata.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> getName(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.date&#125;</span> / (<span class="subst">$&#123;<span class="built_in">this</span>.state.substr(<span class="number">0</span>, <span class="number">9</span>)&#125;</span>...)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> getDate(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.date;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Caretaker doesn&#x27;t depend on the Concrete Memento class. Therefore, it</span></span><br><span class="line"><span class="comment"> * doesn&#x27;t have access to the originator&#x27;s state, stored inside the memento. It</span></span><br><span class="line"><span class="comment"> * works with all mementos via the base Memento interface.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Caretaker &#123;</span><br><span class="line">    <span class="keyword">private</span> mementos: Memento[] = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> originator: Originator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">originator: Originator</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.originator = originator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> backup(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;\nCaretaker: Saving Originator\&#x27;s state...&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.mementos.push(<span class="built_in">this</span>.originator.save());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> undo(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.mementos.length) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> memento = <span class="built_in">this</span>.mementos.pop();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Caretaker: Restoring state to: <span class="subst">$&#123;memento.getName()&#125;</span>`</span>);</span><br><span class="line">        <span class="built_in">this</span>.originator.restore(memento);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> showHistory(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Caretaker: Here\&#x27;s the list of mementos:&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> memento <span class="keyword">of</span> <span class="built_in">this</span>.mementos) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(memento.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Client code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> originator = <span class="keyword">new</span> Originator(<span class="string">&#x27;Super-duper-super-puper-super.&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> caretaker = <span class="keyword">new</span> Caretaker(originator);</span><br><span class="line"></span><br><span class="line">caretaker.backup();</span><br><span class="line">originator.doSomething();</span><br><span class="line"></span><br><span class="line">caretaker.backup();</span><br><span class="line">originator.doSomething();</span><br><span class="line"></span><br><span class="line">caretaker.backup();</span><br><span class="line">originator.doSomething();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">caretaker.showHistory();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;\nClient: Now, let\&#x27;s rollback!\n&#x27;</span>);</span><br><span class="line">caretaker.undo();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;\nClient: Once more!\n&#x27;</span>);</span><br><span class="line">caretaker.undo();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Originator: My initial state is: Super-duper-<span class="built_in">super</span>-puper-<span class="built_in">super</span>.</span><br><span class="line"></span><br><span class="line">Caretaker: Saving Originator<span class="string">&#x27;s state...</span></span><br><span class="line"><span class="string">Originator: I&#x27;</span>m doing something important.</span><br><span class="line">Originator: and my state has changed to: qXqxgTcLSCeLYdcgElOghOFhPGfMxo</span><br><span class="line"></span><br><span class="line">Caretaker: Saving Originator<span class="string">&#x27;s state...</span></span><br><span class="line"><span class="string">Originator: I&#x27;</span>m doing something important.</span><br><span class="line">Originator: and my state has changed to: iaVCJVryJwWwbipieensfodeMSWvUY</span><br><span class="line"></span><br><span class="line">Caretaker: Saving Originator<span class="string">&#x27;s state...</span></span><br><span class="line"><span class="string">Originator: I&#x27;</span>m doing something important.</span><br><span class="line">Originator: and my state has changed to: oSUxsOCiZEnohBMQEjwnPWJLGnwGmy</span><br><span class="line"></span><br><span class="line">Caretaker: Here<span class="string">&#x27;s the list of mementos:</span></span><br><span class="line"><span class="string">2019-02-17 15:14:05 / (Super-dup...)</span></span><br><span class="line"><span class="string">2019-02-17 15:14:05 / (qXqxgTcLS...)</span></span><br><span class="line"><span class="string">2019-02-17 15:14:05 / (iaVCJVryJ...)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Client: Now, let&#x27;</span>s rollback!</span><br><span class="line"></span><br><span class="line">Caretaker: Restoring state to: <span class="number">2019</span><span class="number">-02</span><span class="number">-17</span> <span class="number">15</span>:<span class="number">14</span>:<span class="number">05</span> / (iaVCJVryJ...)</span><br><span class="line">Originator: My state has changed to: iaVCJVryJwWwbipieensfodeMSWvUY</span><br><span class="line"></span><br><span class="line">Client: Once more!</span><br><span class="line"></span><br><span class="line">Caretaker: Restoring state to: <span class="number">2019</span><span class="number">-02</span><span class="number">-17</span> <span class="number">15</span>:<span class="number">14</span>:<span class="number">05</span> / (qXqxgTcLS...)</span><br><span class="line">Originator: My state has changed to: qXqxgTcLSCeLYdcgElOghOFhPGfMxo</span><br></pre></td></tr></table></figure>

<ul>
<li><p>观察者模式: 观察者模式是一种行为设计模式， 允许你定义一种订阅机制， 可在对象事件发生时通知多个 “观察” 该对象的其他对象。</p>
<p>观察者模式优缺点:<br>  优点:</p>
<pre><code>1. 开闭原则。 你无需修改发布者代码就能引入新的订阅者类 （如果是发布者接口则可轻松引入发布者类）。
2. 你可以在运行时建立对象之间的联系。</code></pre>
<p>  缺点:</p>
<pre><code>1. 订阅者的通知顺序是随机的。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Subject interface declares a set of methods for managing subscribers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Subject &#123;</span><br><span class="line">    <span class="comment">// Attach an observer to the subject.</span></span><br><span class="line">    attach(observer: Observer): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Detach an observer from the subject.</span></span><br><span class="line">    detach(observer: Observer): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Notify all observers about an event.</span></span><br><span class="line">    notify(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Subject owns some important state and notifies observers when the state</span></span><br><span class="line"><span class="comment"> * changes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteSubject <span class="keyword">implements</span> Subject &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @type &#123;number&#125; For the sake of simplicity, the Subject&#x27;s state, essential</span></span><br><span class="line"><span class="comment">     * to all subscribers, is stored in this variable.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> state: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @type &#123;Observer[]&#125; List of subscribers. In real life, the list of</span></span><br><span class="line"><span class="comment">     * subscribers can be stored more comprehensively (categorized by event</span></span><br><span class="line"><span class="comment">     * type, etc.).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> observers: Observer[] = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The subscription management methods.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> attach(observer: Observer): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> isExist = <span class="built_in">this</span>.observers.includes(observer);</span><br><span class="line">        <span class="keyword">if</span> (isExist) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;Subject: Observer has been attached already.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Subject: Attached an observer.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.observers.push(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> detach(observer: Observer): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> observerIndex = <span class="built_in">this</span>.observers.indexOf(observer);</span><br><span class="line">        <span class="keyword">if</span> (observerIndex === <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;Subject: Nonexistent observer.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.observers.splice(observerIndex, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Subject: Detached an observer.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Trigger an update in each subscriber.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> notify(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Subject: Notifying observers...&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> observer <span class="keyword">of</span> <span class="built_in">this</span>.observers) &#123;</span><br><span class="line">            observer.update(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Usually, the subscription logic is only a fraction of what a Subject can</span></span><br><span class="line"><span class="comment">     * really do. Subjects commonly hold some important business logic, that</span></span><br><span class="line"><span class="comment">     * triggers a notification method whenever something important is about to</span></span><br><span class="line"><span class="comment">     * happen (or after it).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> someBusinessLogic(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;\nSubject: I\&#x27;m doing something important.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.state = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (<span class="number">10</span> + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Subject: My state has just changed to: <span class="subst">$&#123;<span class="built_in">this</span>.state&#125;</span>`</span>);</span><br><span class="line">        <span class="built_in">this</span>.notify();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Observer interface declares the update method, used by subjects.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Observer &#123;</span><br><span class="line">    <span class="comment">// Receive update from subject.</span></span><br><span class="line">    update(subject: Subject): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Observers react to the updates issued by the Subject they had been</span></span><br><span class="line"><span class="comment"> * attached to.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteObserverA <span class="keyword">implements</span> Observer &#123;</span><br><span class="line">    <span class="keyword">public</span> update(subject: Subject): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (subject <span class="keyword">instanceof</span> ConcreteSubject &amp;&amp; subject.state &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteObserverA: Reacted to the event.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteObserverB <span class="keyword">implements</span> Observer &#123;</span><br><span class="line">    <span class="keyword">public</span> update(subject: Subject): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (subject <span class="keyword">instanceof</span> ConcreteSubject &amp;&amp; (subject.state === <span class="number">0</span> || subject.state &gt;= <span class="number">2</span>)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteObserverB: Reacted to the event.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> subject = <span class="keyword">new</span> ConcreteSubject();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer1 = <span class="keyword">new</span> ConcreteObserverA();</span><br><span class="line">subject.attach(observer1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer2 = <span class="keyword">new</span> ConcreteObserverB();</span><br><span class="line">subject.attach(observer2);</span><br><span class="line"></span><br><span class="line">subject.someBusinessLogic();</span><br><span class="line">subject.someBusinessLogic();</span><br><span class="line"></span><br><span class="line">subject.detach(observer2);</span><br><span class="line"></span><br><span class="line">subject.someBusinessLogic();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Subject: Attached an observer.</span><br><span class="line">Subject: Attached an observer.</span><br><span class="line"></span><br><span class="line">Subject: I<span class="string">&#x27;m doing something important.</span></span><br><span class="line"><span class="string">Subject: My state has just changed to: 6</span></span><br><span class="line"><span class="string">Subject: Notifying observers...</span></span><br><span class="line"><span class="string">ConcreteObserverB: Reacted to the event.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Subject: I&#x27;</span>m doing something important.</span><br><span class="line">Subject: My state has just changed to: <span class="number">1</span></span><br><span class="line">Subject: Notifying observers...</span><br><span class="line">ConcreteObserverA: Reacted to the event.</span><br><span class="line">Subject: Detached an observer.</span><br><span class="line"></span><br><span class="line">Subject: I<span class="string">&#x27;m doing something important.</span></span><br><span class="line"><span class="string">Subject: My state has just changed to: 5</span></span><br><span class="line"><span class="string">Subject: Notifying observers...</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>状态模式: 状态模式是一种行为设计模式， 让你能在一个对象的内部状态变化时改变其行为， 使其看上去就像改变了自身所属的类一样。</p>
<p>状态模式优缺点:<br>  优点:</p>
<pre><code>  1. 单一职责原则。 将与特定状态相关的代码放在单独的类中。
  2. 开闭原则。 无需修改已有状态类和上下文就能引入新状态。
  3. 通过消除臃肿的状态机条件语句简化上下文代码。</code></pre>
<p>  缺点:</p>
<pre><code>  1. 如果状态机只有很少的几个状态， 或者很少发生改变， 那么应用该模式可能会显得小题大作。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Context defines the interface of interest to clients. It also maintains a</span></span><br><span class="line"><span class="comment"> * reference to an instance of a State subclass, which represents the current</span></span><br><span class="line"><span class="comment"> * state of the Context.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Context &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @type &#123;State&#125; A reference to the current state of the Context.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> state: State;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">state: State</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.transitionTo(state);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Context allows changing the State object at runtime.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> transitionTo(state: State): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Context: Transition to <span class="subst">$&#123;(&lt;<span class="built_in">any</span>&gt;state).constructor.name&#125;</span>.`</span>);</span><br><span class="line">        <span class="built_in">this</span>.state = state;</span><br><span class="line">        <span class="built_in">this</span>.state.setContext(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Context delegates part of its behavior to the current State object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> request1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.state.handle1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> request2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.state.handle2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The base State class declares methods that all Concrete State should</span></span><br><span class="line"><span class="comment"> * implement and also provides a backreference to the Context object, associated</span></span><br><span class="line"><span class="comment"> * with the State. This backreference can be used by States to transition the</span></span><br><span class="line"><span class="comment"> * Context to another State.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> State &#123;</span><br><span class="line">    <span class="keyword">protected</span> context: Context;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> setContext(context: Context) &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> handle1(): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> handle2(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete States implement various behaviors, associated with a state of the</span></span><br><span class="line"><span class="comment"> * Context.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteStateA <span class="keyword">extends</span> State &#123;</span><br><span class="line">    <span class="keyword">public</span> handle1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateA handles request1.&#x27;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateA wants to change the state of the context.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.context.transitionTo(<span class="keyword">new</span> ConcreteStateB());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> handle2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateA handles request2.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteStateB <span class="keyword">extends</span> State &#123;</span><br><span class="line">    <span class="keyword">public</span> handle1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateB handles request1.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> handle2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateB handles request2.&#x27;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteStateB wants to change the state of the context.&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.context.transitionTo(<span class="keyword">new</span> ConcreteStateA());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> context = <span class="keyword">new</span> Context(<span class="keyword">new</span> ConcreteStateA());</span><br><span class="line">context.request1();</span><br><span class="line">context.request2();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Context: Transition to ConcreteStateA.</span><br><span class="line">ConcreteStateA handles request1.</span><br><span class="line">ConcreteStateA wants to change the state <span class="keyword">of</span> the context.</span><br><span class="line">Context: Transition to ConcreteStateB.</span><br><span class="line">ConcreteStateB handles request2.</span><br><span class="line">ConcreteStateB wants to change the state <span class="keyword">of</span> the context.</span><br><span class="line">Context: Transition to ConcreteStateA.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>策略模式: 策略模式是一种行为设计模式， 它能让你定义一系列算法， 并将每种算法分别放入独立的类中， 以使算法的对象能够相互替换。</p>
<p>策略模式优缺点<br>  优点:</p>
<pre><code>1. 你可以在运行时切换对象内的算法。
2.你可以将算法的实现和使用算法的代码隔离开来。
3.你可以使用组合来代替继承。
4.开闭原则。 你无需对上下文进行修改就能够引入新的策略。</code></pre>
<p>  缺点:</p>
<pre><code>1.如果你的算法极少发生改变， 那么没有任何理由引入新的类和接口。 使用该模式只会让程序过于复杂。
2.客户端必须知晓策略间的不同——它需要选择合适的策略。
3.许多现代编程语言支持函数类型功能， 允许你在一组匿名函数中实现不同版本的算法。 这样， 你使用这些函数的方式就和使用策略对象时完全相同， 无需借助额外的类和接口来保持代码简洁。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Context defines the interface of interest to clients.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> Context &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @type &#123;Strategy&#125; The Context maintains a reference to one of the Strategy</span></span><br><span class="line"><span class="comment">     * objects. The Context does not know the concrete class of a strategy. It</span></span><br><span class="line"><span class="comment">     * should work with all strategies via the Strategy interface.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> strategy: Strategy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Usually, the Context accepts a strategy through the constructor, but also</span></span><br><span class="line"><span class="comment">     * provides a setter to change it at runtime.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">strategy: Strategy</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Usually, the Context allows replacing a Strategy object at runtime.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> setStrategy(strategy: Strategy) &#123;</span><br><span class="line">        <span class="built_in">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Context delegates some work to the Strategy object instead of</span></span><br><span class="line"><span class="comment">     * implementing multiple versions of the algorithm on its own.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> doSomeBusinessLogic(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Context: Sorting data using the strategy (not sure how it\&#x27;ll do it)&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">this</span>.strategy.doAlgorithm([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]);</span><br><span class="line">        <span class="built_in">console</span>.log(result.join(<span class="string">&#x27;,&#x27;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Strategy interface declares operations common to all supported versions</span></span><br><span class="line"><span class="comment"> * of some algorithm.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The Context uses this interface to call the algorithm defined by Concrete</span></span><br><span class="line"><span class="comment"> * Strategies.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Strategy &#123;</span><br><span class="line">    doAlgorithm(data: <span class="built_in">string</span>[]): <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Strategies implement the algorithm while following the base Strategy</span></span><br><span class="line"><span class="comment"> * interface. The interface makes them interchangeable in the Context.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteStrategyA <span class="keyword">implements</span> Strategy &#123;</span><br><span class="line">    <span class="keyword">public</span> doAlgorithm(data: <span class="built_in">string</span>[]): <span class="built_in">string</span>[] &#123;</span><br><span class="line">        <span class="keyword">return</span> data.sort();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteStrategyB <span class="keyword">implements</span> Strategy &#123;</span><br><span class="line">    <span class="keyword">public</span> doAlgorithm(data: <span class="built_in">string</span>[]): <span class="built_in">string</span>[] &#123;</span><br><span class="line">        <span class="keyword">return</span> data.reverse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code picks a concrete strategy and passes it to the context. The</span></span><br><span class="line"><span class="comment"> * client should be aware of the differences between strategies in order to make</span></span><br><span class="line"><span class="comment"> * the right choice.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> context = <span class="keyword">new</span> Context(<span class="keyword">new</span> ConcreteStrategyA());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Strategy is set to normal sorting.&#x27;</span>);</span><br><span class="line">context.doSomeBusinessLogic();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Client: Strategy is set to reverse sorting.&#x27;</span>);</span><br><span class="line">context.setStrategy(<span class="keyword">new</span> ConcreteStrategyB());</span><br><span class="line">context.doSomeBusinessLogic();</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Client: Strategy is set to normal sorting.</span><br><span class="line">Context: Sorting data using the strategy (not sure how it<span class="string">&#x27;ll do it)</span></span><br><span class="line"><span class="string">a,b,c,d,e</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Client: Strategy is set to reverse sorting.</span></span><br><span class="line"><span class="string">Context: Sorting data using the strategy (not sure how it&#x27;</span>ll <span class="keyword">do</span> it)</span><br><span class="line">e,d,c,b,a</span><br></pre></td></tr></table></figure>

<ul>
<li>模板方法模式<br>模板方法模式优缺点<br>  优点:<pre><code>  1.你可仅允许客户端重写一个大型算法中的特定部分， 使得算法其他部分修改对其所造成的影响减小。
  2.你可将重复代码提取到一个超类中。</code></pre>
  缺点:<pre><code>  1. 部分客户端可能会受到算法框架的限制。
  2.通过子类抑制默认步骤实现可能会导致违反_里氏替换原则_。
  3.模板方法中的步骤越多， 其维护工作就可能会越困难。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Abstract Class defines a template method that contains a skeleton of some</span></span><br><span class="line"><span class="comment"> * algorithm, composed of calls to (usually) abstract primitive operations.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Concrete subclasses should implement these operations, but leave the template</span></span><br><span class="line"><span class="comment"> * method itself intact.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> AbstractClass &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The template method defines the skeleton of an algorithm.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> templateMethod(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.baseOperation1();</span><br><span class="line">        <span class="built_in">this</span>.requiredOperations1();</span><br><span class="line">        <span class="built_in">this</span>.baseOperation2();</span><br><span class="line">        <span class="built_in">this</span>.hook1();</span><br><span class="line">        <span class="built_in">this</span>.requiredOperation2();</span><br><span class="line">        <span class="built_in">this</span>.baseOperation3();</span><br><span class="line">        <span class="built_in">this</span>.hook2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * These operations already have implementations.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> baseOperation1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;AbstractClass says: I am doing the bulk of the work&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> baseOperation2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;AbstractClass says: But I let subclasses override some operations&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> baseOperation3(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;AbstractClass says: But I am doing the bulk of the work anyway&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * These operations have to be implemented in subclasses.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> requiredOperations1(): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> requiredOperation2(): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * These are &quot;hooks.&quot; Subclasses may override them, but it&#x27;s not mandatory</span></span><br><span class="line"><span class="comment">     * since the hooks already have default (but empty) implementation. Hooks</span></span><br><span class="line"><span class="comment">     * provide additional extension points in some crucial places of the</span></span><br><span class="line"><span class="comment">     * algorithm.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> hook1(): <span class="built_in">void</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> hook2(): <span class="built_in">void</span> &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete classes have to implement all abstract operations of the base class.</span></span><br><span class="line"><span class="comment"> * They can also override some operations with a default implementation.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteClass1 <span class="keyword">extends</span> AbstractClass &#123;</span><br><span class="line">    <span class="keyword">protected</span> requiredOperations1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteClass1 says: Implemented Operation1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> requiredOperation2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteClass1 says: Implemented Operation2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Usually, concrete classes override only a fraction of base class&#x27; operations.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteClass2 <span class="keyword">extends</span> AbstractClass &#123;</span><br><span class="line">    <span class="keyword">protected</span> requiredOperations1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteClass2 says: Implemented Operation1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> requiredOperation2(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteClass2 says: Implemented Operation2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> hook1(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ConcreteClass2 says: Overridden Hook1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code calls the template method to execute the algorithm. Client</span></span><br><span class="line"><span class="comment"> * code does not have to know the concrete class of an object it works with, as</span></span><br><span class="line"><span class="comment"> * long as it works with objects through the interface of their base class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">abstractClass: AbstractClass</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    abstractClass.templateMethod();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Same client code can work with different subclasses:&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteClass1());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Same client code can work with different subclasses:&#x27;</span>);</span><br><span class="line">clientCode(<span class="keyword">new</span> ConcreteClass2());</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">Same client code can work <span class="keyword">with</span> different subclasses:</span><br><span class="line">AbstractClass says: I am doing the bulk <span class="keyword">of</span> the work</span><br><span class="line">ConcreteClass1 says: Implemented Operation1</span><br><span class="line">AbstractClass says: But I <span class="keyword">let</span> subclasses override some operations</span><br><span class="line">ConcreteClass1 says: Implemented Operation2</span><br><span class="line">AbstractClass says: But I am doing the bulk <span class="keyword">of</span> the work anyway</span><br><span class="line"></span><br><span class="line">Same client code can work <span class="keyword">with</span> different subclasses:</span><br><span class="line">AbstractClass says: I am doing the bulk <span class="keyword">of</span> the work</span><br><span class="line">ConcreteClass2 says: Implemented Operation1</span><br><span class="line">AbstractClass says: But I <span class="keyword">let</span> subclasses override some operations</span><br><span class="line">ConcreteClass2 says: Overridden Hook1</span><br><span class="line">ConcreteClass2 says: Implemented Operation2</span><br><span class="line">AbstractClass says: But I am doing the bulk <span class="keyword">of</span> the work anyway</span><br></pre></td></tr></table></figure>

<ul>
<li><p>访问者模式: 访问者模式是一种行为设计模式， 它能将算法与其所作用的对象隔离开来。</p>
<p>访问者模式优缺点:<br>  优点:</p>
<pre><code>1. 开闭原则。 你可以引入在不同类对象上执行的新行为， 且无需对这些类做出修改。
2. 单一职责原则。 可将同一行为的不同版本移到同一个类中。
3. 访问者对象可以在与各种对象交互时收集一些有用的信息。 当你想要遍历一些复杂的对象结构 （例如对象树）， 并在结构中的每个对象上应用访问者时， 这些信息可能会有所帮助。</code></pre>
<p>  缺点:</p>
<pre><code>1. 每次在元素层次结构中添加或移除一个类时， 你都要更新所有的访问者。
2. 在访问者同某个元素进行交互时， 它们可能没有访问元素私有成员变量和方法的必要权限。</code></pre>
</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Component interface declares an `accept` method that should take the base</span></span><br><span class="line"><span class="comment"> * visitor interface as an argument.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Component &#123;</span><br><span class="line">    accept(visitor: Visitor): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Each Concrete Component must implement the `accept` method in such a way that</span></span><br><span class="line"><span class="comment"> * it calls the visitor&#x27;s method corresponding to the component&#x27;s class.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteComponentA <span class="keyword">implements</span> Component &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Note that we&#x27;re calling `visitConcreteComponentA`, which matches the</span></span><br><span class="line"><span class="comment">     * current class name. This way we let the visitor know the class of the</span></span><br><span class="line"><span class="comment">     * component it works with.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> accept(visitor: Visitor): <span class="built_in">void</span> &#123;</span><br><span class="line">        visitor.visitConcreteComponentA(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Concrete Components may have special methods that don&#x27;t exist in their</span></span><br><span class="line"><span class="comment">     * base class or interface. The Visitor is still able to use these methods</span></span><br><span class="line"><span class="comment">     * since it&#x27;s aware of the component&#x27;s concrete class.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> exclusiveMethodOfConcreteComponentA(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteComponentB <span class="keyword">implements</span> Component &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Same here: visitConcreteComponentB =&gt; ConcreteComponentB</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> accept(visitor: Visitor): <span class="built_in">void</span> &#123;</span><br><span class="line">        visitor.visitConcreteComponentB(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> specialMethodOfConcreteComponentB(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The Visitor Interface declares a set of visiting methods that correspond to</span></span><br><span class="line"><span class="comment"> * component classes. The signature of a visiting method allows the visitor to</span></span><br><span class="line"><span class="comment"> * identify the exact class of the component that it&#x27;s dealing with.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> Visitor &#123;</span><br><span class="line">    visitConcreteComponentA(element: ConcreteComponentA): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    visitConcreteComponentB(element: ConcreteComponentB): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Concrete Visitors implement several versions of the same algorithm, which can</span></span><br><span class="line"><span class="comment"> * work with all concrete component classes.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * You can experience the biggest benefit of the Visitor pattern when using it</span></span><br><span class="line"><span class="comment"> * with a complex object structure, such as a Composite tree. In this case, it</span></span><br><span class="line"><span class="comment"> * might be helpful to store some intermediate state of the algorithm while</span></span><br><span class="line"><span class="comment"> * executing visitor&#x27;s methods over various objects of the structure.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> ConcreteVisitor1 <span class="keyword">implements</span> Visitor &#123;</span><br><span class="line">    <span class="keyword">public</span> visitConcreteComponentA(element: ConcreteComponentA): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;element.exclusiveMethodOfConcreteComponentA()&#125;</span> + ConcreteVisitor1`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> visitConcreteComponentB(element: ConcreteComponentB): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;element.specialMethodOfConcreteComponentB()&#125;</span> + ConcreteVisitor1`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ConcreteVisitor2 <span class="keyword">implements</span> Visitor &#123;</span><br><span class="line">    <span class="keyword">public</span> visitConcreteComponentA(element: ConcreteComponentA): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;element.exclusiveMethodOfConcreteComponentA()&#125;</span> + ConcreteVisitor2`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> visitConcreteComponentB(element: ConcreteComponentB): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;element.specialMethodOfConcreteComponentB()&#125;</span> + ConcreteVisitor2`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The client code can run visitor operations over any set of elements without</span></span><br><span class="line"><span class="comment"> * figuring out their concrete classes. The accept operation directs a call to</span></span><br><span class="line"><span class="comment"> * the appropriate operation in the visitor object.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clientCode</span>(<span class="params">components: Component[], visitor: Visitor</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> component <span class="keyword">of</span> components) &#123;</span><br><span class="line">        component.accept(visitor);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> components = [</span><br><span class="line">    <span class="keyword">new</span> ConcreteComponentA(),</span><br><span class="line">    <span class="keyword">new</span> ConcreteComponentB(),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;The client code works with all visitors via the base Visitor interface:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> visitor1 = <span class="keyword">new</span> ConcreteVisitor1();</span><br><span class="line">clientCode(components, visitor1);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;It allows the same client code to work with different types of visitors:&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> visitor2 = <span class="keyword">new</span> ConcreteVisitor2();</span><br><span class="line">clientCode(components, visitor2);</span><br><span class="line"></span><br><span class="line">Output: 执行结果</span><br><span class="line">The client code works <span class="keyword">with</span> all visitors via the base Visitor <span class="keyword">interface</span>:</span><br><span class="line">A + ConcreteVisitor1</span><br><span class="line">B + ConcreteVisitor1</span><br><span class="line"></span><br><span class="line">It allows the same client code to work with different types of visitors:</span><br><span class="line">A + ConcreteVisitor2</span><br><span class="line">B + ConcreteVisitor2</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">TheFirstSunday</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://thefirstsunday.github.io/2021/01/29/designPatterns/">https://thefirstsunday.github.io/2021/01/29/designPatterns/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://thefirstsunday.github.io">前端-FE</a>！</span></div></div><div class="post-copyright valine" id="comments-container"><script src="//unpkg.com/valine@1.4.14/dist/Valine.min.js"></script><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2];
}
var flag = false;
var gitFun = function () {
    try {
        var valineObj = window.GLOBAL_CONFIG.valine;
        new Valine({
            el: "#comments-container",
            ...valineObj
        });
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2021/01/29/message/"><i class="fas fa-angle-left">&nbsp;</i><span>四种跨浏览器选项卡实时通信方法</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2020/12/28/caseSensitivity/"><span>git 解决远程仓库文件大小写问题</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2021 By TheFirstSunday</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>